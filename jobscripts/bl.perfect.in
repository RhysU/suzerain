#!/bin/bash
set -eu

# Specify operational defaults which may be overridden in the environment
: ${LAMINAR_INITIAL:=@bindir@/perfect_init}
: ${LAMINAR_ADVANCE:=@bindir@/perfect_advance}

# Parse incoming parameters
OPTS="k:,htdelta:,alpha:,beta:,gamma:,Ly:,Re:,Ma:,Pr:,Re_x:,largo_formulation:,largo_grdelta:,radialflow:"
ARGS=$(getopt -n "$(basename -- "$0")" -o "h" -l "$OPTS,help" -- "$@")
if [ $? -ne 0 ]; then exit 1; fi
eval set -- "$ARGS"

# Process incoming parameters versus defaults
k=6
htdelta=-3
alpha=
beta=
gamma=
Ly=1
Re=3000
Ma=1.5
Pr=0.7
Re_x=3000
largo_formulation=temporal
largo_grdelta=1e-1
radialflow=
while true;
do
    case "$1" in
        --)         shift 1;break;;
        -h|--help)  echo "Usage: $(basename -- "$0") [OPTIONS]... -- [SOLVEROPTS]..."
                    echo "Generate a laminar channel flow solution on your workstation."
                    echo
                    echo "Options:"
                    cat <<EOF | column -t -s "\&" | sed -e 's/^/    /' | sort
-h&--help&Show this help message.
  &--k&Specify the wall-normal B-spline order&${k:+(Default $k)}
  &--htdelta&Set grid stretching factor&${htdelta:+(Default $htdelta)}
  &--alpha&Ratio of bulk to dynamic viscosity&${alpha:+(Default $alpha)}
  &--beta&Temperature power law exponent&${beta:+(Default $beta)}
  &--gamma&Ratio of specific heats&${gamma:+(Default $gamma)}
  &--Ly&Wall-normal domain size&${Ly:+(Default $Ly)}
  &--Re&Reynolds number&${Re:+(Default $Re)}
  &--Ma&Mach number&${Ma:+(Default $Ma)}
  &--Pr&Prandtl number&${Pr:+(Default $Pr)}
  &--Re_x&Used for any laminar boundary layer initialization&${Re_x:+(Default $Re_x)}
  &--largo_formulation&Largo slow growth formulation to activate&${largo_formulation:+(Default $largo_formulation)}
  &--largo_grdelta&Growth rate to use with any active Largo formulation&${largo_grdelta:+(Default $largo_grdelta)}
  &--radialflow&Indexed radial nozzle problem using embedded data&${radialflow:+(Default $radialflow)}
EOF
                    echo
                    echo "GNU parallel is great for managing multiple cases.  For example,"
                    echo "    parallel -u '/h2/rhys/Stow/suzerain-0.1.1/share/suzerain/jobscripts/bl.perfect' --largo_formulation={} -- --explicit ::: temporal spatiotemporal"
                    echo "runs a collection of independent cases in parallel passing"
                    echo "--largo_formulation to set different slow growth options."
                    echo "Output stored in a formulation-, grdelta-, and k-specific directory."
                    exit;;
        --k)                 k="$2";                 shift 2;;
        --htdelta)           htdelta="$2";           shift 2;;
        --alpha)             alpha="$2";             shift 2;;
        --beta)              beta="$2";              shift 2;;
        --gamma)             gamma="$2";             shift 2;;
        --Ly)                Ly="$2";                shift 2;;
        --Re)                Re="$2";                shift 2;;
        --Ma)                Ma="$2";                shift 2;;
        --Pr)                Pr="$2";                shift 2;;
        --Re_x)              Re_x="$2";              shift 2;;
        --largo_formulation) largo_formulation="$2"; shift 2;;
        --largo_grdelta)     largo_grdelta="$2";     shift 2;;
        --radialflow)        radialflow="$2";        shift 2;;
    esac
done

# Clear largo_grdelta whenever an empty formulation is supplied.
test -z "${largo_formulation}" && largo_grdelta=""

# Lookup any requested radialflow data in a maximally grotesque manner.
# Disgusting hoops permit easily updating CSV data embedded at end of file.
if test -n "${radialflow}"; then
	echo Looking radial nozzle problem with index "${radialflow}"...
	read dstag radialflow_{Ma0,gam0,rho1,u1,R1} < <(
		cat <(sed -e '0,/^exit *# *Embedded/d' $0) | awk -f <(cat - <<-'EOD'
			# Modified from http://stackoverflow.com/questions/16092167.
			BEGIN {
			  for (i=1; i<ARGC; ++i)
			    desired[i] = ARGV[i]
			  delete ARGV
			}
			NR==1 {
			  for (i=1; i<=NF; i++)
			    if ($i in names)
			      printf "Duplicate '%s' in column %d\n", $i, i | "cat 1>&2"
			    else
			      names[$i] = i
			  next
			}
			{
			  for (i=1; i<ARGC; ++i)
			    printf "%s%s",                                         \
			         (i==1 ? "" : OFS),                                \
			         ((ndx = names[name = desired[i]])>0 ? $ndx: name)
			  printf RS
			}
			EOD
		) -F, dstag Ma0 gam0 rho1 u1 R0 | sed "${radialflow}!d"
	)
	test -n "${radialflow_Ma0}"  || (echo Problem getting Ma0  && false)
	test -n "${radialflow_gam0}" || (echo Problem getting gam0 && false)
	test -n "${radialflow_rho1}" || (echo Problem getting rho1 && false)
	test -n "${radialflow_u1}"   || (echo Problem getting u1   && false)
	test -n "${radialflow_R1}"   || (echo Problem getting R1   && false)
	echo Loaded data for distance $dstag leeward of stagnation point
	gamma=${radialflow_gam0} && echo Forced --gamma=${gamma}
fi

# Create or overwrite a directory and then change into it
if test -z "${largo_formulation}"; then
  largo_grdelta=  # No formulation implies no grdelta
  dir=$(printf "bl_k%02d%s" "$k")
elif test -z "${radialflow}"; then
  dir=$(printf "%s_%s_k%02d" "${largo_formulation}" "${largo_grdelta}" "$k")
else
  dir=$(printf "%s_%s_k%02d.%02d" "${largo_formulation}" "${largo_grdelta}" "$k" "$radialflow")
fi
rm -rvf $dir
mkdir -v $dir
cd $dir

# Table of incremental cases to run towards getting steady state
Ny=(36 48 64)
dt=(30 10 10)

# Generate an initial condition
"$LAMINAR_INITIAL" t0.h5                                                    \
    --k=$k --Nx=1 --Ny=${Ny[0]} --Nz=1 --htdelta=$htdelta                   \
    ${alpha:+--alpha=$alpha} ${beta:+--beta=$beta} ${gamma:+--gamma=$gamma} \
    ${Re:+--Re=$Re} ${Ma:+--Ma=$Ma} ${Pr:+--Pr=$Pr}                         \
    ${Ly:+--Ly=$Ly} ${Re_x:+--Re_x=$Re_x}                                   \
    ${largo_formulation:+--largo_formulation=$largo_formulation}            \
    ${largo_grdelta:+--largo_grdelta=$largo_grdelta}
cp t0.h5 restart0.h5

# Advance through each situation in the incremental table
declare -i t=0
for i in "${!Ny[@]}"
do
    "$LAMINAR_ADVANCE" restart0.h5 --Ny=${Ny[$i]} --advance_dt=${dt[$i]} \
        ${radialflow_Ma0:+ --radialflow_Ma0=$radialflow_Ma0  }  \
        ${radialflow_gam0:+--radialflow_gam0=$radialflow_gam0}  \
        ${radialflow_rho1:+--radialflow_rho1=$radialflow_rho1}  \
        ${radialflow_u1:+  --radialflow_u1=$radialflow_u1    }  \
        ${radialflow_R1:+  --radialflow_R1=$radialflow_R1    }  \
        --status_nt=100 --restart_retain=10 "$@"
    t+=${dt[$i]}
    cp -v restart0.h5 t${t}.h5
done

exit # Embedded data lifted from notebooks/cev_laminar.out
dstag,delta,gamma_e,Ma_edge,p_exi,T_ratio,delta,gam0,Ma0,R0,rho1,u1,Ma_e,p_exi,a2_e,res2,cvg,niter
4.20056593057338,0.0534632300802907,1.40870838772566,1.19059349352597,-0.0254386055310633,4.00399254866984,1,1.40870838772566,4.51400960230362,94.1175060264331,1,0.527732020306762,1.19059349353638,-0.0254386055307709,4.00399254866922,1.4444120037695e-11,3,29
4.18012004618314,0.0532928359410548,1.40865543018548,1.17444089365608,-0.0188036707264988,4.18642518089931,1,1.40865543018548,4.622700201499,140.178397513133,1,0.519803281387263,1.17444089365864,-0.0188036707263122,4.18642518089899,1.01616875490802e-11,3,30
4.15800971731955,0.0530999145212353,1.4086045117224,1.1621859200981,-0.0146830790375863,4.25453256145504,1,1.4086045117224,4.65581746461676,194.192442647457,1,0.514866846047767,1.16218592010071,-0.0146830790374047,4.25453256145467,1.25702705288251e-11,3,31
4.13410763671912,0.0529508895219637,1.40855425729451,1.15219446848293,-0.0123502691967584,4.28536092206623,1,1.40855425729451,4.66604706699614,247.180603874353,1,0.511167314751426,1.15219446851685,-0.0123502691964563,4.28536092206434,3.82755858729552e-11,3,31
4.10827792961246,0.0528401634051676,1.40850108443895,1.14330804471957,-0.0110660193957915,4.30279271723848,1,1.40850108443895,4.66848749323325,294.192809793644,1,0.507991695126571,1.14330804474078,-0.0110660193952537,4.30279271723683,5.20128741655769e-11,3,32
4.08037609673302,0.0532128682994975,1.40844457551879,1.1348406174945,-0.0102484140459328,4.31196121904763,1,1.40844457551879,4.66590799154828,338.953585978218,1,0.50504659569206,1.13484061784818,-0.0102484140862686,4.31196121903864,3.94812508409998e-09,3,32
4.05024903722457,0.0531650260857238,1.40837815509964,1.12727869758502,-0.0100453626854811,4.31685677368256,1,1.40837815509964,4.66151946324376,367.653905643553,1,0.502438940502429,1.12727869783628,-0.0100453627012229,4.31685677367425,1.5828432250971e-09,3,33
4.01773389500711,0.0537401809596794,1.40831672890949,1.11877513162756,-0.00977363386998435,4.31943705000777,1,1.40831672890949,4.6546340468642,406.556094761041,1,0.499536159000893,1.11877513198577,-0.00977363389915193,4.319437049996,3.0014396620316e-09,3,34
3.98265885473233,0.053761440698257,1.40826581805351,1.10937314260535,-0.00974159657506519,4.32051846820867,1,1.40826581805351,4.64583472656277,444.932422452099,1,0.496338731981587,1.10937314260538,-0.00974159657505058,4.32051846820867,1.49962890316068e-12,3,36
3.94484238743314,0.0540822203918182,1.40822041509651,1.0985922749827,-0.0096502759056395,4.32038282181216,1,1.40822041509651,4.63485819081565,500.817172006664,1,0.492672006581371,1.09859227510555,-0.00965027590281443,4.3203828218022,3.1338510200239e-10,3,37
3.90409406426158,0.0539660922546051,1.40817876848468,1.08746051279033,-0.00969116266914431,4.31968886620226,1,1.40817876848468,4.62322502834717,565.177704504487,1,0.488868048147566,1.08746051295002,-0.00969116266341492,4.31968886618723,6.09171841665251e-10,3,39
3.8602132608989,0.0539100895269955,1.40814034988444,1.07528764259215,-0.0097198961918437,4.31814563814332,1,1.40814034988444,4.61006137812126,658.45932861162,1,0.484689805869596,1.07528764344751,-0.00971989623627293,4.31814563808978,4.63967369634825e-09,3,41
3.81299145025122,0.0536824294002437,1.40810505900575,1.06239820375465,-0.00978688791199172,4.31615473072805,1,1.40810505900575,4.59598562832163,793.97117115855,1,0.480236136088708,1.06239820375485,-0.00978688791175602,4.31615473072802,2.40838583167746e-11,3,43
3.7622106632908,0.0537949757748833,1.40807332032514,1.04815618937302,-0.00973141990003175,4.31343717684176,1,1.40807332032514,4.58020770801322,1041.84747921063,1,0.475281314073945,1.0481561893815,-0.00973141989616706,4.31343717684135,3.97217071137833e-10,3,43
3.70764444304534,0.0536592237075868,1.40804610786178,1.03321957801319,-0.00973671314431556,4.31022538792547,1,1.40804610786178,4.56356364173709,1520.56942370075,1,0.470042588463245,1.03321957826324,-0.00973671325835026,4.310225387919,1.17143265253776e-08,3,45
3.64905980044148,0.0532652944866645,1.40802343190509,1.01773580932371,-0.00983991053770295,4.3057514460811,1,1.40802343190509,4.54572015608805,2839.82763142805,1,0.464575295647573,1.01773580932557,-0.00983991049518763,4.30575144607957,4.32070204742315e-09,3,66
3.5862167095378,0.0530725691548095,1.4080058983226,1.000847126522,-0.00988583360572644,4.30105900039396,1,1.4080058983226,4.52626976323045,38261.0054175766,1,0.458736239842347,1.00132142315675,-0.00988290798523675,4.29991692576068,0.000618599633551064,3,2121
3.51887000536048,0.0530020008638704,1.40799485162051,0.982454941143596,-0.00987111246877669,4.29523555147539,1,1.40799485162051,4.50545860017057,2912.57533455022,1,-0.451926587453033,0.982454941142352,-0.00987111243757652,4.29523555147654,3.16075607861938e-09,3,54
3.44677090372897,0.0525009507297812,1.40799111242671,0.963754024199554,-0.0100047265575915,4.28804144323414,1,1.40799111242671,4.48341720013174,1404.27048435095,1,-0.445131363226281,0.963754023860751,-0.0100047264355928,4.28804144332894,1.21991978687104e-08,3,35
3.36966926001039,0.0521251005805263,1.40799517443881,0.94344288692975,-0.0100872251497693,4.28054569566317,1,1.40799517443881,4.4599718078899,901.931580039543,1,-0.43765890092795,0.943442886862051,-0.010087225137085,4.28054569567873,1.25951207076975e-09,3,26
3.28731412019909,0.0518181324324959,1.40800780900658,0.92143086386963,-0.0101113900427337,4.27146879752048,1,1.40800780900658,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0,10
3.19945813915967,0.0512235012025187,1.40802945791554,0.898581154878258,-0.0101917832088986,4.26191287506515,1,1.40802945791554,4.40793616973877,509.576052027558,1,-0.420852074700651,0.89858115487607,-0.0101917832086831,4.26191287506563,2.12820760999561e-11,3,27
3.10585923586313,0.0503616577862046,1.40805366367592,0.874907731035163,-0.0105731275741183,4.25104254577597,1,1.40805366367592,4.38045948678297,403.269032841077,1,-0.411810428841457,0.874907731033026,-0.0105731275747349,4.25104254577598,5.83678361408749e-11,3,24
3.00628358478505,0.0492305165249237,1.40807909263206,0.849001564975298,-0.010830296722694,4.24008641984585,1,1.40807909263206,4.35155098305167,330.719780195601,1,-0.401754606876014,0.849001564854139,-0.0108302967219541,4.24008641987949,1.5841519534151e-10,3,23
2.90518608293315,0.0485889848987559,1.40812426173766,0.822196402396975,-0.0108400331056012,4.22953875190186,1,1.40812426173766,4.32267104561893,284.737612460728,1,-0.391183776203291,0.82219640232441,-0.0108400331053889,4.22953875191931,9.04981528508843e-11,3,22
2.80408784028128,0.0481163348289906,1.40817694451475,0.795179403512627,-0.0110403711070482,4.21976800322754,1,1.40817694451475,4.29471549197788,246.346928334164,1,-0.380354292042448,0.79517940349816,-0.0110403711070017,4.21976800323161,1.8698818754367e-11,3,20
2.7029893816656,0.0475892979262849,1.40823451139973,0.768170515689662,-0.0113148850447507,4.21123977687508,1,1.40823451139973,4.26818177030395,215.610789012328,1,-0.369348023216124,0.768170515688404,-0.0113148850447747,4.21123977687512,2.68144844467699e-12,3,18
2.60189119289686,0.0470894124138484,1.40829561183873,0.74099081479082,-0.011571158658678,4.20354559204474,1,1.40829561183873,4.24268521378475,191.657536846228,1,-0.358095544203932,0.740990814780299,-0.0115711586587103,4.20354559204664,1.44766162948742e-11,3,17
2.50079333045704,0.0465256786472017,1.40835953700466,0.713944558274654,-0.0118925376493199,4.19607285372368,1,1.40835953700466,4.21806964782694,171.511731283318,1,-0.346732611218719,0.713944558274326,-0.0118925376493281,4.19607285372369,8.28519101246098e-13,3,18
2.39969588330165,0.0459338093173957,1.40842562978072,0.686957012257639,-0.0122853930561962,4.18859440380089,1,1.40842562978072,4.1941385854287,154.141394237021,1,-0.335233479742458,0.686957012255719,-0.0122853930563668,4.18859440380091,1.41674525544264e-11,3,17
2.2985980999688,0.0453871993700074,1.40849291507884,0.659703649560765,-0.0126948924004777,4.18169271806117,1,1.40849291507884,4.17105700797648,139.47627399769,1,-0.323451929194303,0.659703649322918,-0.0126948924297856,4.18169271806526,2.33661740098865e-09,3,17
2.19749996711272,0.0448598303120972,1.40856011493901,0.632302288270884,-0.0131598611992994,4.17481410009113,1,1.40856011493901,4.14857794926654,126.612101547994,1,-0.311444154066761,0.632302285741416,-0.0131598612545035,4.17481410081136,5.79914235181045e-09,3,18
2.09640177975877,0.0443425243428931,1.4086264139082,0.60480443623718,-0.0136903045645956,4.16773846259702,1,1.4086264139082,4.12661493446833,115.178546867978,1,-0.299235716894117,0.604804436236016,-0.0136903045648119,4.16773846259702,1.59162395463204e-11,3,20
1.9953036989241,0.0438498344531514,1.40869147439461,0.577049444071354,-0.0142174273397748,4.16110723779933,1,1.40869147439461,4.10549894920463,105.454124238059,1,-0.286747960270354,0.577049444071322,-0.0142174273397772,4.16110723779933,1.78541825469718e-13,3,20
1.89420586457448,0.0433715959433724,1.40875530640554,0.549272177168697,-0.0147553136194651,4.1541354238844,1,1.40875530640554,4.08488843976105,97.0575636479171,1,-0.274096687685106,0.549272177168239,-0.0147553136194787,4.15413542388452,1.24463340033492e-12,3,20
1.79310835476894,0.0428964757580983,1.40881842997077,0.521444810347493,-0.0152749373058733,4.14827009490219,1,1.40881842997077,4.06569487390589,89.9191907224119,1,-0.261258736180208,0.521444810347402,-0.015274937305876,4.14827009490225,2.484395350175e-13,3,21
1.69201084496332,0.0424283307611799,1.40888083772949,0.493730797296486,-0.0158205970210682,4.1429824977803,1,1.40888083772949,4.04767420976365,83.5878816382276,1,-0.248320966919636,0.493730795207381,-0.0158205971631634,4.14298250643458,1.01458048698373e-08,3,20
1.59091301061371,0.0419504286510321,1.40894246307914,0.466119850897705,-0.0164201395933485,4.13799943900707,1,1.40894246307914,4.03064531757046,77.8089975161876,1,-0.235288074443095,0.46611985079629,-0.0164201395964622,4.13799943945615,3.08340923851539e-10,3,20
1.48981492977903,0.041459564520538,1.40900298407685,0.438622030239511,-0.0171054862870504,4.1334874468324,1,1.40900298407685,4.01471738210014,72.390611536146,1,-0.222170562378085,0.438622030151448,-0.0171054862896497,4.13348744743987,2.91543668298915e-10,3,21
1.38871674242509,0.0409587907937094,1.40906170368494,0.411204144667394,-0.017931635525217,4.12911756692608,1,1.40906170368494,3.99966786596366,67.1189459892032,1,-0.208962513748151,0.411204144563912,-0.0179316355278423,4.12911756796335,3.84538954437421e-10,3,21
1.28761860956901,0.0404668506197087,1.40911784207514,0.383911326999693,-0.0189720659570379,4.12544365088219,1,1.40911784207514,3.98586758681057,61.8234915291252,1,-0.195689184824788,0.38391132698945,-0.0189720659575288,4.1254436509552,4.11663105444431e-11,3,22
1.18652082623616,0.0399821417557573,1.40917127124908,0.356673465048688,-0.0202783088695449,4.12173825150144,1,1.40917127124908,3.97282633883567,56.5042738409141,1,-0.182329670029325,0.356673465033663,-0.0202783088700703,4.12173825168592,6.67014998834666e-11,3,21
1.08542337908076,0.0394439003870411,1.40922147420591,0.329145477947485,-0.0218627948669397,4.117443873646,1,1.40922147420591,3.96007752287705,51.2995436488806,1,-0.168722528695524,0.329145477945317,-0.021862794867089,4.11744387366563,1.06174563657817e-11,3,21
0.984325516640942,0.038915830636841,1.40926817855057,0.30155122032278,-0.023850353644973,4.1125933915687,1,1.40926817855057,3.94774352598265,46.1242981386578,1,-0.154983103461198,0.301551220318219,-0.0238503536451644,4.11259339164423,2.5108787480438e-11,3,22
0.883227327872201,0.0383002385852888,1.40931083650639,0.273500496135618,-0.0262413153567596,4.10723000671068,1,1.40931083650639,3.93575307234302,41.1908405610934,1,-0.140919480382978,0.273500496134705,-0.0262413153568286,4.10723000672373,5.30604131654341e-12,3,23
0.782128869256519,0.0376213062261158,1.40934969499023,0.245141880731296,-0.0292862081807882,4.10109911084092,1,1.40934969499023,3.92402660821839,36.330696242998,1,-0.126612078014551,0.245141880727654,-0.0292862081809045,4.10109911092619,2.58603831136008e-11,3,23
0.681030626604654,0.037019894872499,1.40938389475683,0.216652391318645,-0.033207371957848,4.09337294644076,1,1.40938389475683,3.91211727809053,31.5984572734081,1,-0.112159934538176,0.216652391317576,-0.0332073719579,4.09337294646736,8.30960932833972e-12,3,25
0.579933124752755,0.0362441022778852,1.40941395945078,0.187357870880014,-0.0389271855294091,4.08301416127416,1,1.40941395945078,3.8992497665889,26.6249201979699,1,-0.0972309889955509,0.187357870879508,-0.038927185529439,4.0830141612875,4.30693276644888e-12,3,25
0.480357473674671,0.0360546628166009,1.40943867032696,0.158692001769466,-0.047537526508757,4.07257159034864,1,1.40943867032696,3.88734907995774,21.5806481225228,1,-0.0825618559712669,0.158692001765728,-0.0475375265088287,4.07257159048714,4.13954572284997e-11,3,28
0.386758570378131,0.035526719054842,1.40945818684775,0.130050332120913,-0.0598298434220884,4.06234041172345,1,1.40945818684775,3.87646194981956,17.0026285078318,1,-0.0678542036593459,0.130050332118719,-0.0598298434221274,4.06234041182168,2.94910244366789e-11,3,30
0.298902589338718,0.0350854051507273,1.40947293653004,0.102296483600134,-0.0778779947194611,4.05153526580716,1,1.40947293653004,3.86617996369548,12.9772049594531,1,-0.0535763803661077,0.102296483599125,-0.0778779947194718,4.05153526586352,1.70505394411674e-11,3,36
0.216547449527409,0.0344446209643836,1.40948360209059,0.0745403362187114,-0.109401505110346,4.04079772284605,1,1.40948360209059,0.0785095231219854,9.19232010821227,1,-0.957662696318197,0.0742994033159588,-0.109397529276508,1.00011820818003,0.752501802194292,3,9
0.139445805808833,0.0337669941489482,1.4094907750622,0.0471068973145932,-0.172600174962923,4.03080787014972,1,1.4094907750622,0.0496123211832487,5.8070280086231,1,-0.974785136981604,0.0469660210513267,-0.172597133708858,1.0000389168873,0.75190706772488,3,10
0.0673467041773232,0.0333112263212117,1.40949490700173,0.0206255334359222,-0.322114140052264,4.02213169052502,1,1.40949490700173,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0,0
-0,0.0327468927885077,1.40949658583075,0.00544292059542116,-3.51060478414359,4.0150322591695,1,1.40949658583075,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0,0
-0.0628430909036801,0.0324074357253163,1.40949608780564,0.0300734991458416,-0.39128487154053,4.00816563100248,1,1.40949608780564,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0,0
-0.121427733507534,0.0318943825484194,1.40949373943626,0.0541360529927624,-0.201932038128172,4.00075465977931,1,1.40949373943626,0.0570085876484248,4.96734461932095,1,-0.98518407055361,0.0539718804791537,-0.201926846502756,1.00004480348876,0.750042089774138,3,10
-0.175993953752996,0.0315082194976982,1.40948961082871,0.0768811729161966,-0.143762174406014,3.99183267396435,1,1.40948961082871,0.0809588870401235,6.99816203718455,1,-0.965995710763351,0.0766318928289885,-0.143756099854613,1.00011492262828,0.749466723296068,3,9
-0.226774740713419,0.0309006882762723,1.40948455091185,0.0994655728850365,-0.11274893621616,3.98079659554546,1,1.40948455091185,3.82081780219051,8.95900257625151,1,-0.05259037227469,0.0994655728828684,-0.112748936216119,3.98079659566662,3.7437988702193e-11,3,36
-0.273996551361098,0.0302364421784924,1.4094793324704,0.121737769231512,-0.0958052081159303,3.9669976109162,1,1.4094793324704,3.81456118860083,10.5962823239061,1,-0.064134524404901,0.121737769227862,-0.0958052081159512,3.96699761108189,5.14169673559263e-11,3,32
-0.317877354723778,0.0296938322024435,1.40947509648675,0.143564072817206,-0.0872160180896269,3.95058233207482,1,1.40947509648675,3.80703991383529,11.7088713420713,1,-0.0755055303248825,0.143564072812817,-0.0872160180897017,3.9505823322429,5.23969040035565e-11,3,28
-0.358625677895339,0.0290589665694933,1.40947288329088,0.165601210278575,-0.0819269400309499,3.93134752307625,1,1.40947288329088,3.79817855090785,12.5524163972814,1,-0.0870052740584358,0.165601210277711,-0.0819269400309979,3.9313475231036,8.71750630104273e-12,3,24
-0.396442145194522,0.0279431276564525,1.40947411053767,0.189012675368662,-0.0765967104123026,3.90972351342495,1,1.40947411053767,3.78846169507404,13.5418214210123,1,-0.099198935530422,0.189012675351477,-0.0765967104127238,3.909723513909,1.53705502151093e-10,3,22
-0.431517185469305,0.0270372947702292,1.40948122784338,0.211972198419914,-0.0750176075438679,3.88571897769844,1,1.40948122784338,3.77756554623469,13.9607078102877,1,-0.111193111429232,0.211972198417171,-0.0750176075440176,3.8857189777668,2.19284752178977e-11,3,23
-0.464032327686762,0.0264919683835782,1.4094954447208,0.23489666492711,-0.0764003835022284,3.86021815154532,1,1.4094954447208,3.76610901145172,13.8575304699386,1,-0.12320037435754,0.234896664913248,-0.0764003835027905,3.86021815185198,9.9233583266395e-11,3,23
-0.494159387195216,0.0258149435299483,1.40951892253173,0.259854050070865,-0.0778836386142802,3.83137159979676,1,1.40951892253173,3.75338077752578,13.7746933909379,1,-0.136254306116357,0.259854050067702,-0.0778836386145497,3.83137159985649,2.00784968129035e-11,3,24
-0.522061220074652,0.0248918870557864,1.40955561462925,0.287699576488236,-0.0792126399875244,3.79990172686669,1,1.40955561462925,3.74019483148432,13.7700175727807,1,-0.150771611968394,0.287699576470951,-0.0792126399885919,3.79990172715849,9.84269758876609e-11,3,23
-0.547890927181313,0.0242841658874237,1.40961082964018,0.316407370837904,-0.0834470451263528,3.76440926441521,1,1.40961082964018,3.72514783185344,13.3251944322487,1,-0.165778243537915,0.316407370832465,-0.0834470451269892,3.76440926448782,2.69389545174905e-11,3,22
-0.571793007781747,0.0236814015172534,1.40969080574555,0.347787575207355,-0.0891823430958451,3.7199291691044,1,1.40969080574555,3.70549181939332,12.766663341591,1,-0.18221191514514,0.347787575169232,-0.0891823430993321,3.71992916956588,1.70100697563822e-10,3,22
-0.593903336645341,0.0226977038719499,1.4098104536888,0.382612486388944,-0.095023446053763,3.64799239455554,1,1.4098104536888,3.66886279733578,12.3424139899323,1,-0.200605534535588,0.382612486082038,-0.0950234460963976,3.64799239752866,1.22839450347655e-09,3,21
-0.614349221035578,0.0215829534994773,1.40998154293905,0.421906940279728,-0.101010869464995,3.48729994520408,1,1.40998154293905,3.57193812309242,12.0617378020733,1,-0.222258742618329,0.421906940067959,-0.101010869503148,3.4872999465288,7.34103071912596e-10,3,21
