\documentclass[letterpaper,reqno,11pt]{amsart}

% Packages
\usepackage{accents}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage{fullpage}
\usepackage{lastpage}
\usepackage{latexsym}
\usepackage{mathtools}
\usepackage{pstricks}
\usepackage{setspace}
\usepackage{txfonts}

\mathtoolsset{showmanualtags}
\allowdisplaybreaks[1]

% Line Spacing
\singlespacing

% Set appropriate header/footer information on each page
\fancypagestyle{plain}{
    \fancyhf{}
    \renewcommand{\headheight}{2.0em}
    \renewcommand{\headsep}{0.75em}
    \renewcommand{\headrulewidth}{1.0pt}
    \renewcommand{\footrulewidth}{0pt}
    \lhead{
        SMR's hybrid Runge-Kutta scheme implementation
    }
    \rhead{
        Page \thepage{} of \pageref{LastPage}
    }
}
\pagestyle{plain}

% Paragraph spacing
\setlength{\parindent}{0em}
\setlength{\parskip}{2.0ex plus 0.75ex minus 0.75ex}

% Document-specific commands
\newcommand{\trans}[1]{{#1}^{\ensuremath{\mathsf{T}}}}
\newcommand{\order}[2]{\ensuremath{O\!\left( {#1}^{#2} \right)}}

\begin{document}

We start from equations in Appendix A of Spalart, Moser, and
Rogers' 1991 ``Spectral Methods for the Navier-Stokes Equations
with One Infinite and Two Periodic Directions'' published in
\emph{J. Comput. Phys.} volume 96 pages 297--324:
\begin{subequations}
\begin{align}
  u'
  &=
  u_{n}
  + \Delta{}t\left[
      L\left( \alpha_{1}u_{n} + \beta_{1}u' \right)
    + \gamma_{1} N(u_{n})
  \right]
  \tag{SMR A4a}
  \label{eq:SMR_A4a}
\\
  u''
  &=
  u'
  + \Delta{}t\left[
    L\left( \alpha_{2}u' + \beta_{2}u'' \right)
    + \gamma_{2} N(u') + \zeta_{1} N(u_{n})
  \right]
  \tag{SMR A4b}
  \label{eq:SMR_A4b}
\\
  u_{n+1}
  &=
  u''
  + \Delta{}t\left[
      L\left( \alpha_{3}u'' + \beta_{3}u_{n+1} \right)
    + \gamma_{3} N(u'') + \zeta_{2} N(u')
  \right]
  \tag{SMR A4c}
  \label{eq:SMR_A4c}
\end{align}
\begin{align}
  \alpha_1 + \beta_1 &= \gamma_1
  &
  \alpha_2 + \beta_2 &= \gamma_2 + \zeta_1
  &
  \alpha_3 + \beta_3 &= \gamma_3 + \zeta_2
  \tag{SMR A5}
\end{align}
\end{subequations}
The authors determined the above coefficients to be
\begin{align*}
  \alpha_1, \alpha_2, \alpha_3 &= \left\{
    \frac{29}{96}, -\frac{3}{40},  \frac{1}{6}
  \right\}
  &
  \beta_1, \beta_2, \beta_3 &= \left\{
    \frac{37}{160}, \frac{5}{24}, \frac{1}{6}
  \right\}
  \\
  \gamma_1, \gamma_2, \gamma_3 &= \left\{
    \frac{8}{15}, \frac{5}{12}, \frac{3}{4}
  \right\}
  &
  \zeta_0, \zeta_1, \zeta_2 &= \left\{
    0, -\frac{17}{60}, -\frac{5}{12}
  \right\}
\end{align*}
We have added $\zeta_0=0$.  Each substep \eqref{eq:SMR_A4a}--\eqref{eq:SMR_A4c}
has the general form
\begin{align}
  u^{i+1} &= u^i + \Delta{}t \left[
        \alpha_{i} L u^i
      + \beta_{i}  L u^{i+1}
      + \gamma_{i} N\left( u^{i} \right)
      + \zeta_{i-1} N\left( u^{i-1} \right)
  \right]
  \label{eq:generalsubstep}
\end{align}
where $i\in\left\{ 1,2,3 \right\}$ is the substep number.

We rewrite the general substep equation as
\begin{align}
  \left(I - \Delta{}t\beta_{i}L\right) u^{i+1}
  &=
  \left(I + \Delta{}t\alpha_{i}L\right) u^{i}
  + \Delta{}t\gamma_{i}N\left(u^{i}\right)
  + \Delta{}t\zeta_{i-1}N\left(u^{i-1}\right)
  \label{eq:generaloperatorsubstep}
\end{align}
to make it apparent that this time advancement scheme requires implementations
of $u\mapsto{}N\left(u\right)$, $u\mapsto{}\left(I+\varphi{}L\right)u$, and
$u\mapsto{}\left(I+\varphi{}L\right)^{-1}u$ for some arbitrary scalar
$\varphi$.  To achieve a low storage implementation, the $N\left(u\right)$ and
$\left(I+\varphi{}L\right)^{-1}$ implementations must operate in-place while
$\left(I+\varphi{}L\right)$ must operate out-of-place.  Given only two storage
locations $a$ and $b$, each substep computation follows algorithm
\ref{alg:substep}.

\begin{algorithm}
\caption{Compute one substep in the SMR scheme following
         equation \eqref{eq:generaloperatorsubstep}}
\label{alg:substep}
\begin{algorithmic}
  \REQUIRE Storage $a = u^i$;
           storage $b = N\left(u^{i-1}\right)$
  \STATE $b\leftarrow{}\Delta{}t\zeta_{i-1}b$
  \STATE $b\leftarrow{}b + \left(I+\Delta{}t\alpha_{i}L\right)a$
  \STATE $a\leftarrow{}N\left(a\right)$
  \STATE $b\leftarrow{}b + \Delta{}t\gamma_{i}a$
  \STATE $b\leftarrow{}\left(I-\Delta{}t\beta_{i}L\right)^{-1}b$
  \ENSURE Storage $a = N\left(u^{i}\right)$;
          storage $b = u^{i+1}$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{Compute all substeps in the SMR scheme following
         equation \eqref{eq:generaloperatorsubstep}}
\label{alg:step}
\begin{algorithmic}
  \REQUIRE Storage $a = u\left(t\right) = u^{0} $;
           storage $b$'s contents undefined
  \STATE $b\leftarrow{}a$
  \STATE $b\leftarrow{}N\left(b\right)$
  \STATE Compute $\Delta{}t$ from $a=u^0$ and $b=N\left(u^0\right)$
  \STATE $a\leftarrow{}\left(I+\Delta{}t\alpha_{1}L\right)a$
  \STATE $a\leftarrow{}a + \Delta{}t \gamma_{1} b$
  \STATE $a\leftarrow{}\left(I-\Delta{}t\beta_{1}L\right)^{-1}a$
  \ENSURE Storage $a = u^1$;
          storage $b = N\left(u^{0}\right)$
  \STATE $b\leftarrow{}\Delta{}t\zeta_{1}b$
  \STATE $b\leftarrow{}b + \left(I+\Delta{}t\alpha_{2}L\right)a$
  \STATE $a\leftrightarrow{}b$
  \STATE $b\leftarrow{}N\left(b\right)$
  \STATE $a\leftarrow{}a + \Delta{}t \gamma_{2} b$
  \STATE $a\leftarrow{}\left(I-\Delta{}t\beta_{2}L\right)^{-1}a$
  \ENSURE Storage $a = u^{2}$;
          storage $b = N\left(u^{1}\right)$
  \STATE $b\leftarrow{}\Delta{}t\zeta_{2}b$
  \STATE $b\leftarrow{}b + \left(I+\Delta{}t\alpha_{3}L\right)a$
  \STATE $a\leftrightarrow{}b$
  \STATE $b\leftarrow{}N\left(b\right)$
  \STATE $a\leftarrow{}a + \Delta{}t \gamma_{3} b$
  \STATE $a\leftarrow{}\left(I-\Delta{}t\beta_{3}L\right)^{-1}a$
  \ENSURE Storage $a = u\left(t+\Delta{}t\right)= u^{3}$;
          storage $b = N\left(u^{2}\right)$
\end{algorithmic}
\end{algorithm}

\end{document}
