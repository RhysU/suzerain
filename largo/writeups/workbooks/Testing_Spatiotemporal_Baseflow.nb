(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     43537,       1034]
NotebookOptionsPosition[     40954,        941]
NotebookOutlinePosition[     41295,        956]
CellTagsIndexPosition[     41252,        953]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.590956222058013*^9}],

Cell[CellGroupData[{

Cell["\<\
Slow Growth Library Testing - Spatiotemporal Model\
\>", "Subtitle",
 CellChangeTimes->{{3.570808544626232*^9, 3.570808573714147*^9}, {
  3.5886985621391697`*^9, 3.588698577816818*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.584884576420198*^9, 3.5848845764247017`*^9}}],

Cell[CellGroupData[{

Cell["Functions to Compute Slow Growth Sources", "Section",
 CellChangeTimes->{{3.57080847353741*^9, 3.570808479800851*^9}, {
  3.5708085999223347`*^9, 3.570808621633946*^9}, {3.5708146652377377`*^9, 
  3.570814665372693*^9}}],

Cell[CellGroupData[{

Cell["Inputs", "Subsection",
 CellChangeTimes->{{3.584884158310474*^9, 3.584884159374331*^9}}],

Cell[CellGroupData[{

Cell["Test case parameters", "Subsubsection",
 CellChangeTimes->{{3.584884170894958*^9, 3.584884175510556*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"neq", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ns", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", " ", "=", " ", 
   RowBox[{"1", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uIw", " ", "=", " ", "460"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grtDelta", " ", "=", " ", 
    RowBox[{"5", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"grxDelta", " ", "=", " ", 
    RowBox[{"grtDelta", " ", "/", " ", "uIw"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grxDelta", " ", "=", 
   FractionBox["1", "9200"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grtDAmean", " ", "=", " ", 
    RowBox[{"List", "[", 
     RowBox[{
      RowBox[{"2", "/", "100"}], ",", 
      RowBox[{"1", "/", "10"}], ",", 
      RowBox[{"1", "/", "100"}], ",", 
      RowBox[{"3", "/", "100"}], ",", 
      RowBox[{"4", "/", "100"}], ",", 
      RowBox[{"1", "/", "1000"}], ",", 
      RowBox[{"2", "/", "1000"}], ",", " ", 
      RowBox[{"1", "/", "100"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"grxDAmean", " ", "=", " ", 
    RowBox[{"grtDAmean", " ", "/", " ", "uIw"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grxDAmean", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     FractionBox["1", "23000"], ",", 
     FractionBox["1", "4600"], ",", 
     FractionBox["1", "46000"], ",", 
     FractionBox["3", "46000"], ",", 
     FractionBox["1", "11500"], ",", 
     FractionBox["1", "460000"], ",", 
     FractionBox["1", "230000"], ",", 
     FractionBox["1", "46000"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grtDArms", " ", "=", " ", 
    RowBox[{"List", "[", 
     RowBox[{
      RowBox[{"1", "/", "1000"}], ",", 
      RowBox[{"5", "/", "1000"}], ",", 
      RowBox[{"5", "/", "10000"}], ",", 
      RowBox[{"2", "/", "1000"}], ",", 
      RowBox[{"1", "/", "1000"}], ",", 
      RowBox[{"1", "/", "100000"}], ",", 
      RowBox[{"2", "/", "100000"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"grxDArms", " ", "=", " ", 
    RowBox[{"grtDArms", " ", "/", " ", "uIw"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grxDArms", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     FractionBox["1", "460000"], ",", 
     FractionBox["1", "92000"], ",", 
     FractionBox["1", "920000"], ",", 
     FractionBox["1", "230000"], ",", 
     FractionBox["1", "460000"], ",", 
     FractionBox["1", "46000000"], ",", 
     FractionBox["1", "23000000"]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.570808820823238*^9, 3.5708088406465187`*^9}, {
   3.571600138563006*^9, 3.571600205171687*^9}, {3.571600270084647*^9, 
   3.5716003366202374`*^9}, {3.571600379214128*^9, 3.571600380948927*^9}, {
   3.571600865729797*^9, 3.571600911979203*^9}, {3.571600993773541*^9, 
   3.5716009970293217`*^9}, {3.5716010419893837`*^9, 3.571601045069579*^9}, {
   3.571601103366397*^9, 3.571601106326242*^9}, {3.571601297920209*^9, 
   3.5716013271504517`*^9}, {3.571601913089364*^9, 3.571601917659775*^9}, {
   3.571602390328569*^9, 3.571602405899335*^9}, {3.571602983455928*^9, 
   3.5716030236899433`*^9}, {3.571603070603055*^9, 3.571603074483185*^9}, {
   3.57160311089085*^9, 3.5716031857319803`*^9}, {3.571603225515627*^9, 
   3.5716032552991877`*^9}, {3.571603328445211*^9, 3.5716034434617643`*^9}, {
   3.5716034917913103`*^9, 3.5716035020942717`*^9}, {3.571603607871249*^9, 
   3.571603627054497*^9}, {3.57160372951164*^9, 3.57160373584774*^9}, {
   3.571604197795497*^9, 3.5716041980837584`*^9}, {3.571604284189571*^9, 
   3.571604361766242*^9}, {3.571604397815206*^9, 3.5716045407304*^9}, {
   3.5735527100790052`*^9, 3.5735528753110523`*^9}, 3.573553714338347*^9, {
   3.5848841893250847`*^9, 3.5848842005436773`*^9}, {3.584885051874407*^9, 
   3.5848850558334923`*^9}, {3.584885085841971*^9, 3.584885106276751*^9}, {
   3.584886094838292*^9, 3.584886158383909*^9}, {3.588614833777835*^9, 
   3.58861489211018*^9}, {3.588617610253976*^9, 3.5886176211021757`*^9}, {
   3.588698611525219*^9, 3.588698620716506*^9}, {3.588699901837305*^9, 
   3.5886999410406313`*^9}, {3.5886999757328787`*^9, 
   3.5887001061762877`*^9}, {3.588700144751491*^9, 3.588700155639327*^9}, {
   3.588700249864373*^9, 3.5887003201360197`*^9}, {3.5891104733633327`*^9, 
   3.589110483498686*^9}, 3.589110538221367*^9, {3.5891120204615583`*^9, 
   3.589112063974456*^9}, {3.5909562676267633`*^9, 3.590956270094201*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Index numbering", "Subsubsection",
 CellChangeTimes->{{3.5836019884508*^9, 3.5836019973216*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"irho", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"irhoU", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"irhoV", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"irhoW", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"irhoE", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"irho1", " ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"irho2", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ip", "  ", "=", " ", "8"}], ";"}]}], "Input",
 CellChangeTimes->{{3.570808820823238*^9, 3.5708088406465187`*^9}, {
   3.571600138563006*^9, 3.571600205171687*^9}, {3.571600270084647*^9, 
   3.5716003366202374`*^9}, {3.571600379214128*^9, 3.571600380948927*^9}, {
   3.571600865729797*^9, 3.571600911979203*^9}, {3.571600993773541*^9, 
   3.5716009970293217`*^9}, {3.5716010419893837`*^9, 3.571601045069579*^9}, {
   3.571601103366397*^9, 3.571601106326242*^9}, {3.571601297920209*^9, 
   3.5716013271504517`*^9}, {3.571601913089364*^9, 3.571601917659775*^9}, {
   3.571602390328569*^9, 3.571602405899335*^9}, {3.571602983455928*^9, 
   3.5716030236899433`*^9}, {3.571603070603055*^9, 3.571603074483185*^9}, {
   3.57160311089085*^9, 3.5716031857319803`*^9}, {3.571603225515627*^9, 
   3.5716032552991877`*^9}, {3.571603328445211*^9, 3.5716034434617643`*^9}, {
   3.5716034917913103`*^9, 3.5716035020942717`*^9}, {3.571603607871249*^9, 
   3.571603627054497*^9}, {3.57160372951164*^9, 3.57160373584774*^9}, {
   3.571604197795497*^9, 3.5716041980837584`*^9}, {3.571604284189571*^9, 
   3.571604361766242*^9}, {3.571604397815206*^9, 3.5716045407304*^9}, {
   3.5735527100790052`*^9, 3.5735528753110523`*^9}, 3.573553714338347*^9, {
   3.57529905165092*^9, 3.575299103592017*^9}, {3.5752991912351913`*^9, 
   3.5752991945624943`*^9}, {3.575300547500201*^9, 3.575300657113187*^9}, {
   3.5753007462751303`*^9, 3.5753007534423313`*^9}, {3.575305899355218*^9, 
   3.575306103872602*^9}, {3.575306260015924*^9, 3.575306289807933*^9}, {
   3.575306350603529*^9, 3.57530640311012*^9}, {3.575306468068097*^9, 
   3.5753064705162163`*^9}, {3.57530695987132*^9, 3.5753070235689983`*^9}, {
   3.5753071080202227`*^9, 3.575307147740663*^9}, 3.5753071800211887`*^9, {
   3.5753074587491083`*^9, 3.575307560389371*^9}, {3.575307643955021*^9, 
   3.5753076940700703`*^9}, {3.5753077386038218`*^9, 3.575307738796281*^9}, {
   3.575307883516876*^9, 3.575307908279426*^9}, {3.575308171886964*^9, 
   3.575308204088019*^9}, {3.5753082855702868`*^9, 3.5753082955238867`*^9}, {
   3.575308328651326*^9, 3.575308403894787*^9}, {3.575309177219963*^9, 
   3.575309216308527*^9}, {3.575309340004168*^9, 3.575309353804028*^9}, {
   3.5753095759335003`*^9, 3.575309588773041*^9}, {3.575309636221534*^9, 
   3.5753097372140913`*^9}, {3.575309817296719*^9, 3.575309827434031*^9}, {
   3.575310135646222*^9, 3.575310167515675*^9}, {3.575310214668972*^9, 
   3.575310230861474*^9}, {3.57531028177244*^9, 3.575310351904262*^9}, {
   3.5753104094046917`*^9, 3.57531057110288*^9}, {3.575311817653246*^9, 
   3.5753118414607267`*^9}, {3.5753120450753403`*^9, 
   3.5753121235689173`*^9}, {3.575312166394168*^9, 3.575312279668416*^9}, {
   3.575390330836853*^9, 3.575390351755732*^9}, {3.575390385663723*^9, 
   3.575390418041635*^9}, {3.575390816570921*^9, 3.575390834933482*^9}, {
   3.575391030319254*^9, 3.5753910781348743`*^9}, {3.575391407511368*^9, 
   3.575391408693062*^9}, {3.575393632912979*^9, 3.57539363311298*^9}, {
   3.575394311135414*^9, 3.575394351628281*^9}, {3.575394427477764*^9, 
   3.575394509525567*^9}, {3.5753945663018923`*^9, 3.5753947789535646`*^9}, {
   3.575394810884281*^9, 3.575394969208744*^9}, {3.575395050360783*^9, 
   3.575395136714809*^9}, {3.5753952412135572`*^9, 3.575395259471509*^9}, {
   3.575396124061728*^9, 3.575396124423451*^9}, {3.575396200739677*^9, 
   3.57539621747796*^9}, {3.5753962663058987`*^9, 3.575396302423568*^9}, {
   3.575396776687435*^9, 3.575396853434988*^9}, 3.5753981418139267`*^9, {
   3.575399526178379*^9, 3.5753995340386066`*^9}, {3.5753996727403393`*^9, 
   3.5753997009091454`*^9}, {3.575399745128183*^9, 3.575399749491029*^9}, {
   3.575400154692396*^9, 3.5754002084881163`*^9}, 3.575400238772748*^9, 
   3.583599578611204*^9, {3.583599746002383*^9, 3.58359977083503*^9}, {
   3.5836018400881577`*^9, 3.5836018433332872`*^9}, 3.583601974763588*^9, {
   3.583602016020212*^9, 3.5836020185893307`*^9}, {3.588702391718195*^9, 
   3.58870239825261*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Field variables (\[Rho], \[Rho]u, \[Rho]v, \[Rho]w, \[Rho]E, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "s1"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "s2"], TraditionalForm]]],
 ",p)"
}], "Subsubsection",
 CellChangeTimes->{{3.584884206374847*^9, 3.5848842106470337`*^9}, {
  3.584886024742824*^9, 3.584886076192197*^9}, {3.588698629163287*^9, 
  3.5886986293940573`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"field", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"11", "/", "1000"}], ",", 
     RowBox[{"485", "/", "100"}], ",", 
     RowBox[{"2", "/", "10"}], ",", " ", 
     RowBox[{"3", "/", "10"}], ",", " ", "41500", ",", 
     RowBox[{"2", "/", "10000"}], ",", " ", 
     RowBox[{"1", "/", "10000"}], ",", "4100"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mean", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"1", "/", "100"}], ",", " ", 
     RowBox[{"45", "/", "10"}], ",", " ", 
     RowBox[{"1", "/", "1000"}], ",", " ", 
     RowBox[{"5", "/", "100"}], ",", " ", "41200", ",", 
     RowBox[{"2", "/", "1000"}], ",", 
     RowBox[{"1", "/", "1000"}], ",", "4000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dymean", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"1", "/", "10"}], ",", " ", "45", ",", " ", 
     RowBox[{"1", "/", "100"}], ",", " ", 
     RowBox[{"5", "/", "10"}], ",", " ", "412000", ",", 
     RowBox[{"2", "/", "100"}], ",", 
     RowBox[{"1", "/", "100"}], ",", "42000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rms", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"4", "/", "10000"}], ",", 
     RowBox[{"25", "/", "100"}], ",", 
     RowBox[{"15", "/", "100"}], ",", " ", 
     RowBox[{"1", "/", "10"}], ",", " ", "300", ",", 
     RowBox[{"8", "/", "100000"}], ",", 
     RowBox[{"4", "/", "100000"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyrms", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"42", "/", "1000"}], ",", 
     RowBox[{"24", "/", "10"}], ",", 
     RowBox[{"153", "/", "100"}], ",", 
     RowBox[{"12", "/", "10"}], ",", "3200", ",", 
     RowBox[{"82", "/", "10000"}], ",", " ", 
     RowBox[{"41", "/", "10000"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.570808820823238*^9, 3.5708088406465187`*^9}, {
   3.571600138563006*^9, 3.571600205171687*^9}, {3.571600270084647*^9, 
   3.5716003366202374`*^9}, {3.571600379214128*^9, 3.571600380948927*^9}, {
   3.571600865729797*^9, 3.571600911979203*^9}, {3.571600993773541*^9, 
   3.5716009970293217`*^9}, {3.5716010419893837`*^9, 3.571601045069579*^9}, {
   3.571601103366397*^9, 3.571601106326242*^9}, {3.571601297920209*^9, 
   3.5716013271504517`*^9}, {3.571601913089364*^9, 3.571601917659775*^9}, {
   3.571602390328569*^9, 3.571602405899335*^9}, {3.571602983455928*^9, 
   3.5716030236899433`*^9}, {3.571603070603055*^9, 3.571603074483185*^9}, {
   3.57160311089085*^9, 3.5716031857319803`*^9}, {3.571603225515627*^9, 
   3.5716032552991877`*^9}, {3.571603328445211*^9, 3.5716034434617643`*^9}, {
   3.5716034917913103`*^9, 3.5716035020942717`*^9}, {3.571603607871249*^9, 
   3.571603627054497*^9}, {3.57160372951164*^9, 3.57160373584774*^9}, {
   3.571604197795497*^9, 3.5716041980837584`*^9}, {3.571604284189571*^9, 
   3.571604361766242*^9}, {3.571604397815206*^9, 3.5716045407304*^9}, {
   3.5735527100790052`*^9, 3.5735528753110523`*^9}, 3.573553714338347*^9, {
   3.5848841893250847`*^9, 3.5848842005436773`*^9}, {3.584884239236553*^9, 
   3.584884246215889*^9}, {3.5848853534594173`*^9, 3.584885356483226*^9}, {
   3.588698649422982*^9, 3.588698710757208*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Baseflow values", "Subsubsection",
 CellChangeTimes->{{3.584885138070635*^9, 3.584885148167349*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"base", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"5", "/", "1000"}], ",", " ", 
     RowBox[{"25", "/", "10"}], ",", " ", 
     RowBox[{"5", "/", "10000"}], ",", " ", 
     RowBox[{"2", "/", "100"}], ",", " ", "20000", ",", 
     RowBox[{"1", "/", "1000"}], ",", 
     RowBox[{"5", "/", "10000"}], ",", "2000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dybase", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"5", "/", "100"}], ",", " ", "25", ",", " ", 
     RowBox[{"5", "/", "1000"}], ",", " ", 
     RowBox[{"2", "/", "10"}], ",", " ", "200000", ",", 
     RowBox[{"1", "/", "100"}], ",", 
     RowBox[{"5", "/", "1000"}], ",", "20000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dtbase", " ", "=", " ", 
    RowBox[{"List", "[", 
     RowBox[{
      RowBox[{"2", "/", "1000"}], ",", " ", 
      RowBox[{"15", "/", "10"}], ",", " ", 
      RowBox[{"2", "/", "10000"}], ",", " ", 
      RowBox[{"1", "/", "100"}], ",", " ", "10000", ",", 
      RowBox[{"5", "/", "10000"}], ",", 
      RowBox[{"2", "/", "10000"}], ",", "1000"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"dxbase", " ", "=", " ", 
    RowBox[{"dtbase", " ", "/", " ", "uIw"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxbase", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     FractionBox["1", "230000"], ",", 
     FractionBox["3", "920"], ",", 
     FractionBox["1", "2300000"], ",", 
     FractionBox["1", "46000"], ",", 
     FractionBox["500", "23"], ",", 
     FractionBox["1", "920000"], ",", 
     FractionBox["1", "2300000"], ",", 
     FractionBox["50", "23"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"srcbase", " ", "=", " ", 
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"1", "/", "100000"}], ",", " ", 
     RowBox[{"5", "/", "1000"}], ",", " ", 
     RowBox[{"1", "/", "1000000"}], ",", " ", 
     RowBox[{"5", "/", "100000"}], ",", " ", "50", ",", 
     RowBox[{"2", "/", "1000000"}], ",", 
     RowBox[{"1", "/", "1000000"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.570808820823238*^9, 3.5708088406465187`*^9}, {
   3.571600138563006*^9, 3.571600205171687*^9}, {3.571600270084647*^9, 
   3.5716003366202374`*^9}, {3.571600379214128*^9, 3.571600380948927*^9}, {
   3.571600865729797*^9, 3.571600911979203*^9}, {3.571600993773541*^9, 
   3.5716009970293217`*^9}, {3.5716010419893837`*^9, 3.571601045069579*^9}, {
   3.571601103366397*^9, 3.571601106326242*^9}, {3.571601297920209*^9, 
   3.5716013271504517`*^9}, {3.571601913089364*^9, 3.571601917659775*^9}, {
   3.571602390328569*^9, 3.571602405899335*^9}, {3.571602983455928*^9, 
   3.5716030236899433`*^9}, {3.571603070603055*^9, 3.571603074483185*^9}, {
   3.57160311089085*^9, 3.5716031857319803`*^9}, {3.571603225515627*^9, 
   3.5716032552991877`*^9}, {3.571603328445211*^9, 3.5716034434617643`*^9}, {
   3.5716034917913103`*^9, 3.5716035020942717`*^9}, {3.571603607871249*^9, 
   3.571603627054497*^9}, {3.57160372951164*^9, 3.57160373584774*^9}, {
   3.571604197795497*^9, 3.5716041980837584`*^9}, {3.571604284189571*^9, 
   3.571604361766242*^9}, {3.571604397815206*^9, 3.5716045407304*^9}, {
   3.5735527100790052`*^9, 3.5735528753110523`*^9}, 3.573553714338347*^9, {
   3.5848841893250847`*^9, 3.5848842005436773`*^9}, {3.584884239236553*^9, 
   3.584884246215889*^9}, {3.584885166606082*^9, 3.584885276683154*^9}, {
   3.584886222723505*^9, 3.584886348564703*^9}, {3.5848869266814833`*^9, 
   3.584886998756568*^9}, {3.584887286319317*^9, 3.58488735307236*^9}, {
   3.5848874439534616`*^9, 3.584887453489485*^9}, {3.588698748747382*^9, 
   3.588698772378152*^9}, {3.5886988639392023`*^9, 3.588698870571925*^9}, {
   3.588701583226132*^9, 3.58870167316476*^9}, {3.58912227467029*^9, 
   3.5891222747980423`*^9}, {3.589122313717749*^9, 3.589122418838751*^9}, 
   3.589126095310515*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computed from input", "Subsection",
 CellChangeTimes->{{3.584884269951666*^9, 3.584884274295108*^9}}],

Cell[CellGroupData[{

Cell["Compute Favre averages", "Subsubsection",
 CellChangeTimes->{{3.5836013765577517`*^9, 3.583601404221833*^9}, {
  3.583601725775693*^9, 3.5836017267996397`*^9}, {3.588702404650757*^9, 
  3.5887024061623907`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fav", " ", "=", " ", 
   RowBox[{"mean", "/", 
    RowBox[{"mean", "[", 
     RowBox[{"[", "irho", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.570808820823238*^9, 3.5708088406465187`*^9}, {
   3.571600138563006*^9, 3.571600205171687*^9}, {3.571600270084647*^9, 
   3.5716003366202374`*^9}, {3.571600379214128*^9, 3.571600380948927*^9}, {
   3.571600865729797*^9, 3.571600911979203*^9}, {3.571600993773541*^9, 
   3.5716009970293217`*^9}, {3.5716010419893837`*^9, 3.571601045069579*^9}, {
   3.571601103366397*^9, 3.571601106326242*^9}, {3.571601297920209*^9, 
   3.5716013271504517`*^9}, {3.571601913089364*^9, 3.571601917659775*^9}, {
   3.571602390328569*^9, 3.571602405899335*^9}, {3.571602983455928*^9, 
   3.5716030236899433`*^9}, {3.571603070603055*^9, 3.571603074483185*^9}, {
   3.57160311089085*^9, 3.5716031857319803`*^9}, {3.571603225515627*^9, 
   3.5716032552991877`*^9}, {3.571603328445211*^9, 3.5716034434617643`*^9}, {
   3.5716034917913103`*^9, 3.5716035020942717`*^9}, {3.571603607871249*^9, 
   3.571603627054497*^9}, {3.57160372951164*^9, 3.57160373584774*^9}, {
   3.571604197795497*^9, 3.5716041980837584`*^9}, {3.571604284189571*^9, 
   3.571604361766242*^9}, {3.571604397815206*^9, 3.5716045407304*^9}, {
   3.5735527100790052`*^9, 3.5735528753110523`*^9}, 3.573553714338347*^9, {
   3.57529905165092*^9, 3.575299103592017*^9}, {3.5752991912351913`*^9, 
   3.5752991945624943`*^9}, {3.575300547500201*^9, 3.575300657113187*^9}, {
   3.5753007462751303`*^9, 3.5753007534423313`*^9}, {3.575305899355218*^9, 
   3.575306103872602*^9}, {3.575306260015924*^9, 3.575306289807933*^9}, {
   3.575306350603529*^9, 3.57530640311012*^9}, {3.575306468068097*^9, 
   3.5753064705162163`*^9}, {3.57530695987132*^9, 3.5753070235689983`*^9}, {
   3.5753071080202227`*^9, 3.575307147740663*^9}, 3.5753071800211887`*^9, {
   3.5753074587491083`*^9, 3.575307560389371*^9}, {3.575307643955021*^9, 
   3.5753076940700703`*^9}, {3.5753077386038218`*^9, 3.575307738796281*^9}, {
   3.575307883516876*^9, 3.575307908279426*^9}, {3.575308171886964*^9, 
   3.575308204088019*^9}, {3.5753082855702868`*^9, 3.5753082955238867`*^9}, {
   3.575308328651326*^9, 3.575308403894787*^9}, {3.575309177219963*^9, 
   3.575309216308527*^9}, {3.575309340004168*^9, 3.575309353804028*^9}, {
   3.5753095759335003`*^9, 3.575309588773041*^9}, {3.575309636221534*^9, 
   3.5753097372140913`*^9}, {3.575309817296719*^9, 3.575309827434031*^9}, {
   3.575310135646222*^9, 3.575310167515675*^9}, {3.575310214668972*^9, 
   3.575310230861474*^9}, {3.57531028177244*^9, 3.575310351904262*^9}, {
   3.5753104094046917`*^9, 3.57531057110288*^9}, {3.575311817653246*^9, 
   3.5753118414607267`*^9}, {3.5753120450753403`*^9, 
   3.5753121235689173`*^9}, {3.575312166394168*^9, 3.575312279668416*^9}, {
   3.575390330836853*^9, 3.575390351755732*^9}, {3.575390385663723*^9, 
   3.575390418041635*^9}, {3.575390816570921*^9, 3.575390834933482*^9}, {
   3.575391030319254*^9, 3.5753910781348743`*^9}, {3.575391407511368*^9, 
   3.575391408693062*^9}, {3.575393632912979*^9, 3.57539363311298*^9}, {
   3.575394311135414*^9, 3.575394351628281*^9}, {3.575394427477764*^9, 
   3.575394509525567*^9}, {3.5753945663018923`*^9, 3.5753947789535646`*^9}, {
   3.575394810884281*^9, 3.575394969208744*^9}, {3.575395050360783*^9, 
   3.575395136714809*^9}, {3.5753952412135572`*^9, 3.575395259471509*^9}, {
   3.575396124061728*^9, 3.575396124423451*^9}, {3.575396200739677*^9, 
   3.57539621747796*^9}, {3.5753962663058987`*^9, 3.575396302423568*^9}, {
   3.575396776687435*^9, 3.575396853434988*^9}, 3.5753981418139267`*^9, {
   3.575399526178379*^9, 3.5753995340386066`*^9}, {3.5753996727403393`*^9, 
   3.5753997009091454`*^9}, {3.575399745128183*^9, 3.575399749491029*^9}, {
   3.575400154692396*^9, 3.5754002084881163`*^9}, 3.575400238772748*^9, 
   3.583599578611204*^9, 3.583599742898494*^9, 3.583600029837826*^9, 
   3.588702587727549*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{"fav", "[", 
    RowBox[{"[", "irhoU", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{"fav", "[", 
    RowBox[{"[", "irhoV", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"fav", "[", 
    RowBox[{"[", "irhoW", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"En", "=", 
   RowBox[{"fav", "[", 
    RowBox[{"[", "irhoE", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"fav", "[", 
    RowBox[{"[", "irho1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", "=", 
   RowBox[{"fav", "[", 
    RowBox[{"[", "irho2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{
    RowBox[{"fav", "[", 
     RowBox[{"[", "irhoE", "]"}], "]"}], "+", 
    RowBox[{"fav", "[", 
     RowBox[{"[", "ip", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.588702464210436*^9, 3.58870259558889*^9}, {
  3.588702655536467*^9, 3.588702684306109*^9}, {3.588709159831996*^9, 
  3.588709178761148*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fluctuations", "Subsubsection",
 CellChangeTimes->{{3.58488425185507*^9, 3.5848842846000433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fluc", " ", "=", " ", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"field", "-", "mean"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.570808820823238*^9, 3.5708088406465187`*^9}, {
   3.571600138563006*^9, 3.571600205171687*^9}, {3.571600270084647*^9, 
   3.5716003366202374`*^9}, {3.571600379214128*^9, 3.571600380948927*^9}, {
   3.571600865729797*^9, 3.571600911979203*^9}, {3.571600993773541*^9, 
   3.5716009970293217`*^9}, {3.5716010419893837`*^9, 3.571601045069579*^9}, {
   3.571601103366397*^9, 3.571601106326242*^9}, {3.571601297920209*^9, 
   3.5716013271504517`*^9}, {3.571601913089364*^9, 3.571601917659775*^9}, {
   3.571602390328569*^9, 3.571602405899335*^9}, {3.571602983455928*^9, 
   3.5716030236899433`*^9}, {3.571603070603055*^9, 3.571603074483185*^9}, {
   3.57160311089085*^9, 3.5716031857319803`*^9}, {3.571603225515627*^9, 
   3.5716032552991877`*^9}, {3.571603328445211*^9, 3.5716034434617643`*^9}, {
   3.5716034917913103`*^9, 3.5716035020942717`*^9}, {3.571603607871249*^9, 
   3.571603627054497*^9}, {3.57160372951164*^9, 3.57160373584774*^9}, {
   3.571604197795497*^9, 3.5716041980837584`*^9}, {3.571604284189571*^9, 
   3.571604361766242*^9}, {3.571604397815206*^9, 3.5716045407304*^9}, {
   3.5735527100790052`*^9, 3.5735528753110523`*^9}, 3.573553714338347*^9, {
   3.5848841893250847`*^9, 3.5848842005436773`*^9}, {3.584884239236553*^9, 
   3.584884246215889*^9}, {3.588703232884494*^9, 3.588703239316862*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix to compute spatial sources: src = M Xs", "Subsubsection",
 CellChangeTimes->{{3.5887021404239283`*^9, 3.588702187679585*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", " ", "=", 
   RowBox[{"(", " ", GridBox[{
      {"0", "1", "0", "0", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "u"}], "*", "u"}], 
       RowBox[{"2", "u"}], "0", "0", "0", "0", "0", "1"},
      {
       RowBox[{
        RowBox[{"-", "u"}], "*", "v"}], "v", "u", "0", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "u"}], "*", "w"}], "w", "0", "u", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "u"}], "*", "H"}], "H", "0", "0", "u", "0", "0", "u"},
      {
       RowBox[{
        RowBox[{"-", "u"}], "*", "c1"}], "c1", "0", "0", "0", "u", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "u"}], "*", "c2"}], "c2", "0", "0", "0", "0", "u", "0"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588702190425952*^9, 3.588702192689828*^9}, {
  3.5887022603872433`*^9, 3.588702301426405*^9}, {3.5887024482802677`*^9, 
  3.588702448413505*^9}, {3.5887026096094427`*^9, 3.588702634198936*^9}, {
  3.5887026912657022`*^9, 3.588702708015786*^9}, {3.588702958996394*^9, 
  3.588702980124172*^9}, {3.5887030216668*^9, 3.588703069312368*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compute baseflow source from baseflow mean and Euler equation\
\>", "Subsubsection",
 CellChangeTimes->{{3.5891267685495768`*^9, 3.589126805253913*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"favI", " ", "=", " ", 
   RowBox[{"base", "/", 
    RowBox[{"base", "[", 
     RowBox[{"[", "irho", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.570808820823238*^9, 3.5708088406465187`*^9}, {
   3.571600138563006*^9, 3.571600205171687*^9}, {3.571600270084647*^9, 
   3.5716003366202374`*^9}, {3.571600379214128*^9, 3.571600380948927*^9}, {
   3.571600865729797*^9, 3.571600911979203*^9}, {3.571600993773541*^9, 
   3.5716009970293217`*^9}, {3.5716010419893837`*^9, 3.571601045069579*^9}, {
   3.571601103366397*^9, 3.571601106326242*^9}, {3.571601297920209*^9, 
   3.5716013271504517`*^9}, {3.571601913089364*^9, 3.571601917659775*^9}, {
   3.571602390328569*^9, 3.571602405899335*^9}, {3.571602983455928*^9, 
   3.5716030236899433`*^9}, {3.571603070603055*^9, 3.571603074483185*^9}, {
   3.57160311089085*^9, 3.5716031857319803`*^9}, {3.571603225515627*^9, 
   3.5716032552991877`*^9}, {3.571603328445211*^9, 3.5716034434617643`*^9}, {
   3.5716034917913103`*^9, 3.5716035020942717`*^9}, {3.571603607871249*^9, 
   3.571603627054497*^9}, {3.57160372951164*^9, 3.57160373584774*^9}, {
   3.571604197795497*^9, 3.5716041980837584`*^9}, {3.571604284189571*^9, 
   3.571604361766242*^9}, {3.571604397815206*^9, 3.5716045407304*^9}, {
   3.5735527100790052`*^9, 3.5735528753110523`*^9}, 3.573553714338347*^9, {
   3.57529905165092*^9, 3.575299103592017*^9}, {3.5752991912351913`*^9, 
   3.5752991945624943`*^9}, {3.575300547500201*^9, 3.575300657113187*^9}, {
   3.5753007462751303`*^9, 3.5753007534423313`*^9}, {3.575305899355218*^9, 
   3.575306103872602*^9}, {3.575306260015924*^9, 3.575306289807933*^9}, {
   3.575306350603529*^9, 3.57530640311012*^9}, {3.575306468068097*^9, 
   3.5753064705162163`*^9}, {3.57530695987132*^9, 3.5753070235689983`*^9}, {
   3.5753071080202227`*^9, 3.575307147740663*^9}, 3.5753071800211887`*^9, {
   3.5753074587491083`*^9, 3.575307560389371*^9}, {3.575307643955021*^9, 
   3.5753076940700703`*^9}, {3.5753077386038218`*^9, 3.575307738796281*^9}, {
   3.575307883516876*^9, 3.575307908279426*^9}, {3.575308171886964*^9, 
   3.575308204088019*^9}, {3.5753082855702868`*^9, 3.5753082955238867`*^9}, {
   3.575308328651326*^9, 3.575308403894787*^9}, {3.575309177219963*^9, 
   3.575309216308527*^9}, {3.575309340004168*^9, 3.575309353804028*^9}, {
   3.5753095759335003`*^9, 3.575309588773041*^9}, {3.575309636221534*^9, 
   3.5753097372140913`*^9}, {3.575309817296719*^9, 3.575309827434031*^9}, {
   3.575310135646222*^9, 3.575310167515675*^9}, {3.575310214668972*^9, 
   3.575310230861474*^9}, {3.57531028177244*^9, 3.575310351904262*^9}, {
   3.5753104094046917`*^9, 3.57531057110288*^9}, {3.575311817653246*^9, 
   3.5753118414607267`*^9}, {3.5753120450753403`*^9, 
   3.5753121235689173`*^9}, {3.575312166394168*^9, 3.575312279668416*^9}, {
   3.575390330836853*^9, 3.575390351755732*^9}, {3.575390385663723*^9, 
   3.575390418041635*^9}, {3.575390816570921*^9, 3.575390834933482*^9}, {
   3.575391030319254*^9, 3.5753910781348743`*^9}, {3.575391407511368*^9, 
   3.575391408693062*^9}, {3.575393632912979*^9, 3.57539363311298*^9}, {
   3.575394311135414*^9, 3.575394351628281*^9}, {3.575394427477764*^9, 
   3.575394509525567*^9}, {3.5753945663018923`*^9, 3.5753947789535646`*^9}, {
   3.575394810884281*^9, 3.575394969208744*^9}, {3.575395050360783*^9, 
   3.575395136714809*^9}, {3.5753952412135572`*^9, 3.575395259471509*^9}, {
   3.575396124061728*^9, 3.575396124423451*^9}, {3.575396200739677*^9, 
   3.57539621747796*^9}, {3.5753962663058987`*^9, 3.575396302423568*^9}, {
   3.575396776687435*^9, 3.575396853434988*^9}, 3.5753981418139267`*^9, {
   3.575399526178379*^9, 3.5753995340386066`*^9}, {3.5753996727403393`*^9, 
   3.5753997009091454`*^9}, {3.575399745128183*^9, 3.575399749491029*^9}, {
   3.575400154692396*^9, 3.5754002084881163`*^9}, 3.575400238772748*^9, 
   3.583599578611204*^9, 3.583599742898494*^9, 3.583600029837826*^9, 
   3.588702587727549*^9, {3.5891268104329243`*^9, 3.5891268218729067`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uI", " ", "=", " ", 
   RowBox[{"favI", "[", 
    RowBox[{"[", "irhoU", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vI", " ", "=", " ", 
   RowBox[{"favI", "[", 
    RowBox[{"[", "irhoV", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wI", " ", "=", " ", 
   RowBox[{"favI", "[", 
    RowBox[{"[", "irhoW", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnI", "=", 
   RowBox[{"favI", "[", 
    RowBox[{"[", "irhoE", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1I", "=", 
   RowBox[{"favI", "[", 
    RowBox[{"[", "irho1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2I", "=", 
   RowBox[{"favI", "[", 
    RowBox[{"[", "irho2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HI", " ", "=", " ", 
   RowBox[{
    RowBox[{"favI", "[", 
     RowBox[{"[", "irhoE", "]"}], "]"}], "+", 
    RowBox[{"favI", "[", 
     RowBox[{"[", "ip", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.588702464210436*^9, 3.58870259558889*^9}, {
  3.588702655536467*^9, 3.588702684306109*^9}, {3.588709159831996*^9, 
  3.588709178761148*^9}, {3.589126824456764*^9, 3.589126868769761*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MIdx", " ", "=", 
   RowBox[{"(", " ", GridBox[{
      {"0", "1", "0", "0", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "uI"}], "*", "uI"}], 
       RowBox[{"2", "uI"}], "0", "0", "0", "0", "0", "1"},
      {
       RowBox[{
        RowBox[{"-", "uI"}], "*", "vI"}], "vI", "uI", "0", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "uI"}], "*", "wI"}], "wI", "0", "uI", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "uI"}], "*", "HI"}], "HI", "0", "0", "uI", "0", "0", 
       "uI"},
      {
       RowBox[{
        RowBox[{"-", "uI"}], "*", "c1I"}], "c1I", "0", "0", "0", "u", "0", 
       "0"},
      {
       RowBox[{
        RowBox[{"-", "uI"}], "*", "c2I"}], "c2I", "0", "0", "0", "0", "u", "0"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5891318626946993`*^9, 3.589131863024663*^9}, {
  3.589131896430924*^9, 3.589131941290019*^9}, {3.589131972295055*^9, 
  3.589131995808433*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MIdy", " ", "=", 
   RowBox[{"(", " ", GridBox[{
      {"0", "0", "1", "0", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "vI"}], "*", "uI"}], "vI", "uI", "0", "0", "0", "0", "1"},
      {
       RowBox[{
        RowBox[{"-", "vI"}], "*", "vI"}], "0", 
       RowBox[{"2", "vI"}], "0", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "vI"}], "*", "wI"}], "0", "wI", "vI", "0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "vI"}], "*", "HI"}], "0", "HI", "0", "vI", "0", "0", 
       "vI"},
      {
       RowBox[{
        RowBox[{"-", "vI"}], "*", "c1I"}], "0", "c1I", "0", "0", "vI", "0", 
       "0"},
      {
       RowBox[{
        RowBox[{"-", "vI"}], "*", "c2I"}], "0", "c2I", "0", "0", "0", "vI", 
       "0"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5891320078244267`*^9, 3.589132137245263*^9}, {
  3.589132293065989*^9, 3.5891322963900747`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"srcbase1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Dot", "[", 
    RowBox[{"MIdx", ",", "dxbase"}], "]"}], " ", "+", "  ", 
   RowBox[{"Dot", "[", 
    RowBox[{"MIdy", ",", "dybase"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.589132216200264*^9, 3.589132256287757*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["19", "2300"], ",", 
   FractionBox["920315", "46"], ",", 
   FractionBox["19", "23000"], ",", 
   FractionBox["81", "2300"], ",", 
   FractionBox["891000", "23"], ",", 
   FractionBox["157", "92000"], ",", 
   FractionBox["37", "46000"]}], "}"}]], "Output",
 CellChangeTimes->{{3.589132272098611*^9, 3.589132299371846*^9}, 
   3.589132466286462*^9, 3.5909562807790337`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Source", "Section",
 CellChangeTimes->{{3.571603465242427*^9, 3.5716034706265783`*^9}}],

Cell[CellGroupData[{

Cell["Compute sources for mean", "Subsubsection",
 CellChangeTimes->{{3.584884313911949*^9, 3.584884329864739*^9}, {
  3.584884365936426*^9, 3.584884367784503*^9}, {3.588698816971822*^9, 
  3.588698820275175*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Xs", " ", "=", "  ", 
   RowBox[{
    RowBox[{"-", "dxbase"}], " ", "-", " ", 
    RowBox[{"grxDAmean", " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{"mean", "-", "base"}], ")"}]}], "+", 
    RowBox[{"y", "*", "grxDelta", "*", 
     RowBox[{"(", 
      RowBox[{"dymean", "-", "dybase"}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588698823868009*^9, 3.588698846081192*^9}, {
   3.588698896290242*^9, 3.588698928345915*^9}, 3.588703075125848*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"srcMean", " ", "=", " ", 
  RowBox[{
   RowBox[{"Dot", "[", 
    RowBox[{"M", ",", "Xs"}], "]"}], "+", "srcbase"}]}]], "Input",
 CellChangeTimes->{{3.588702320906452*^9, 3.588702337772292*^9}, {
  3.5891222701595087`*^9, 3.589122282786002*^9}, {3.589122612949153*^9, 
  3.589122614916748*^9}, {3.5891258402175217`*^9, 3.5891258439920387`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["7977", "2300000"]}], ",", 
   RowBox[{"-", 
    FractionBox["78923", "18400"]}], ",", 
   RowBox[{"-", 
    FractionBox["15729", "46000000"]}], ",", 
   RowBox[{"-", 
    FractionBox["16089", "920000"]}], ",", 
   RowBox[{"-", 
    FractionBox["413010", "23"]}], ",", 
   RowBox[{"-", 
    FractionBox["35553", "46000000"]}], ",", 
   RowBox[{"-", 
    FractionBox["15549", "46000000"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5887024288294*^9, 3.588703076846957*^9, 3.588709345118338*^9, 
   3.589110488765239*^9, {3.58911056381435*^9, 3.589110586356491*^9}, 
   3.5891120731592073`*^9, {3.5891222874256573`*^9, 3.589122294221216*^9}, 
   3.589122615638266*^9, 3.589125845227017*^9, 3.5891261030177517`*^9, 
   3.589132466384864*^9, 3.590956280947885*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute sources for rms", "Subsubsection",
 CellChangeTimes->{{3.584884343103713*^9, 3.58488437641635*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"srcRms", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", " ", "uIw"}], "*", "grxDArms", " ", "*", " ", "fluc"}], "+", 
   
   RowBox[{"y", "*", "uIw", "*", "grxDelta", "*", "fluc", "*", 
    FractionBox["dyrms", "rms"]}]}]}]], "Input",
 CellChangeTimes->{{3.571603533205855*^9, 3.571603601647603*^9}, {
   3.571603632608375*^9, 3.571603643006123*^9}, {3.5716036962128067`*^9, 
   3.571603697742507*^9}, {3.5716042166525927`*^9, 3.571604219526636*^9}, {
   3.571604521231245*^9, 3.571604522270969*^9}, 3.584885347652335*^9, {
   3.58861492959454*^9, 3.588614946032893*^9}, {3.588617488326426*^9, 
   3.58861749038232*^9}, {3.589110437338217*^9, 3.5891104490864162`*^9}, {
   3.589110580223324*^9, 3.58911058299973*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["131", "250000"], ",", 
   FractionBox["301", "20000"], ",", 
   FractionBox["20099", "2000000"], ",", 
   FractionBox["29", "2000"], ",", 
   FractionBox["157", "10"], ",", 
   RowBox[{"-", 
    FractionBox["461241", "500000000"]}], ",", 
   RowBox[{"-", 
    FractionBox["28827", "62500000"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.584884981369513*^9, 3.584885382981296*^9, 3.584886004283787*^9, 
   3.584886195846387*^9, 3.584887006085746*^9, 3.58488931914491*^9, 
   3.588614963666264*^9, 3.5886175023436737`*^9, 3.5886176243136053`*^9, 
   3.588618363706284*^9, 3.5887030940954933`*^9, 3.588703245738813*^9, 
   3.588709345171933*^9, 3.589110488837484*^9, {3.589110563959631*^9, 
   3.5891105864304523`*^9}, 3.5891120732787247`*^9, 3.589132466462366*^9, 
   3.5909562810079536`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export for testing", "Subsection",
 CellChangeTimes->{{3.571603845063746*^9, 3.571603867118038*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"path", "=", 
  "\"\</org/centers/pecos/users/topalian/share/slow_growth/test_functions/\>\"\
"}]], "Input",
 CellChangeTimes->{{3.5716039459312363`*^9, 3.57160395952911*^9}}],

Cell[BoxData["\<\"/org/centers/pecos/users/topalian/share/slow_growth/test_\
functions/\"\>"], "Output",
 CellChangeTimes->{
  3.584884981373314*^9, 3.5848853830296917`*^9, 3.584886004332542*^9, 
   3.584886195903677*^9, 3.584887006089513*^9, 3.5848893192030983`*^9, 
   3.588614963765792*^9, 3.588617502407668*^9, 3.5886176243176193`*^9, 
   3.588618363792706*^9, 3.588709345232629*^9, 3.589110488964559*^9, {
   3.589110563964549*^9, 3.589110586435192*^9}, 3.589112073350705*^9, 
   3.589132466467214*^9, 3.59095628110738*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "\"\<temporal_srcMean_test_function.dat\>\""}], ",",
     "srcMean", ",", "\"\<Table\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5716038739721947`*^9, 3.571603897099856*^9}, {
  3.5716039800135403`*^9, 3.571604005035706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "\"\<temporal_srcRms_test_function.dat\>\""}], ",", 
    "srcRms", ",", "\"\<Table\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.571604028972148*^9, 3.571604035603787*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{815, 1122},
WindowMargins->{{Automatic, -1756}, {Automatic, -25}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 87, 1, 50, "Input"],
Cell[CellGroupData[{
Cell[669, 25, 195, 4, 51, "Subtitle"],
Cell[867, 31, 144, 2, 30, "Input"],
Cell[CellGroupData[{
Cell[1036, 37, 226, 3, 71, "Section"],
Cell[CellGroupData[{
Cell[1287, 44, 94, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[1406, 49, 111, 1, 27, "Subsubsection"],
Cell[1520, 52, 4600, 102, 335, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6157, 159, 102, 1, 27, "Subsubsection"],
Cell[6262, 162, 4592, 70, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10891, 237, 442, 13, 29, "Subsubsection"],
Cell[11336, 252, 3305, 71, 107, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14678, 328, 106, 1, 27, "Subsubsection"],
Cell[14787, 331, 3968, 84, 171, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18804, 421, 107, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[18936, 426, 217, 3, 27, "Subsubsection"],
Cell[19156, 431, 3954, 57, 30, "Input"],
Cell[23113, 490, 1189, 34, 145, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24339, 529, 104, 1, 27, "Subsubsection"],
Cell[24446, 532, 1524, 24, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26007, 561, 138, 1, 27, "Subsubsection"],
Cell[26148, 564, 1149, 29, 117, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27334, 598, 162, 3, 27, "Subsubsection"],
Cell[27499, 603, 4005, 57, 30, "Input"],
Cell[31507, 662, 1249, 34, 145, "Input"],
Cell[32759, 698, 996, 29, 117, "Input"],
Cell[33758, 729, 959, 29, 117, "Input"],
Cell[CellGroupData[{
Cell[34742, 762, 294, 7, 30, "Input"],
Cell[35039, 771, 429, 11, 54, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35541, 790, 101, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[35667, 795, 213, 3, 27, "Subsubsection"],
Cell[35883, 800, 493, 12, 30, "Input"],
Cell[CellGroupData[{
Cell[36401, 816, 367, 7, 30, "Input"],
Cell[36771, 825, 836, 22, 54, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37656, 853, 113, 1, 27, "Subsubsection"],
Cell[CellGroupData[{
Cell[37794, 858, 750, 14, 55, "Input"],
Cell[38547, 874, 849, 19, 54, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39445, 899, 106, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[39576, 904, 198, 4, 30, "Input"],
Cell[39777, 910, 528, 8, 29, "Output"]
}, Open  ]],
Cell[40320, 921, 323, 7, 30, "Input"],
Cell[40646, 930, 268, 6, 30, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
