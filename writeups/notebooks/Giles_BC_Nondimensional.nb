(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     52711,       1555]
NotebookOptionsPosition[     50052,       1464]
NotebookOutlinePosition[     50390,       1479]
CellTagsIndexPosition[     50347,       1476]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Giles-like Nonreflecting Boundary Conditions\
\>", "Section",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
   3.5806423084853277`*^9, 3.580642331507161*^9}, {3.580642488305594*^9, 
   3.580642489088316*^9}, 3.580642952694499*^9}],

Cell["\<\
See Suzerain perfect gas model document for full details.\
\>", "Text",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.580642349925385*^9, 3.580642354003263*^9}, {3.580642483761999*^9, 
  3.5806424848963413`*^9}, {3.580642956614702*^9, 3.580642957717833*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "\"\<Utilities`CleanSlate`\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CleanSlate", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"C", ",", "E"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"C", ",", "E"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Rho]", ",", "u", ",", "v", ",", "w", ",", "E", ",", "c", ",", 
       "\[Gamma]", ",", "Ma"}], "}"}], "\[Element]", "Reals"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Rho]", ">", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"E", "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"a", ">", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]", ">", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Ma", ">", "0"}]}], "\[IndentingNewLine]", "}"}]}]}], "Input",
 CellChangeTimes->{{3.5806438461478148`*^9, 3.5806438972524023`*^9}, {
  3.580643931221283*^9, 3.580643948249342*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  (CleanSlate) Contexts purged: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "\<\"Global`\"\>", "}"}]}],
  SequenceForm["  (CleanSlate) Contexts purged: ", {"Global`"}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.5806438933285227`*^9, 3.580643897719219*^9}, {
   3.580643932584804*^9, 3.580643949645195*^9}, 3.580644290549698*^9, {
   3.580644774590646*^9, 3.5806448065045958`*^9}, 3.5806468585336018`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  (CleanSlate) Approximate kernel memory recovered: \"\>", 
   "\[InvisibleSpace]", "\<\"191 Kb\"\>"}],
  SequenceForm[
  "  (CleanSlate) Approximate kernel memory recovered: ", "191 Kb"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.5806438933285227`*^9, 3.580643897719219*^9}, {
   3.580643932584804*^9, 3.580643949645195*^9}, 3.580644290549698*^9, {
   3.580644774590646*^9, 3.5806448065045958`*^9}, 3.580646858587452*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
     "\[Rho]", "|", "u", "|", "v", "|", "w", "|", "c", "|", "\[Gamma]", "|", 
      "Ma"}], ")"}], "\[Element]", "Reals"}], ",", 
   RowBox[{"\[Rho]", ">", "0"}], ",", "True", ",", 
   RowBox[{"a", ">", "0"}], ",", 
   RowBox[{"\[Gamma]", ">", "1"}], ",", 
   RowBox[{"Ma", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5806439326428328`*^9, 3.580643949671851*^9}, 
   3.580644290580472*^9, {3.580644774594449*^9, 3.580644806553404*^9}, 
   3.580646858589738*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conservative-to-primitive Jacobian\
\>", "Subsection",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.5806423084853277`*^9, 3.580642331507161*^9}, {3.580642488305594*^9, 
  3.580642489088316*^9}, {3.5806426710861607`*^9, 3.5806426773878813`*^9}}],

Cell["\<\
Nondimensional, conserved state variables per model document.\
\>", "Text",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.580642349925385*^9, 3.580642444321022*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Rho]", ",", "\[Rho]u", ",", "\[Rho]v", ",", "\[Rho]w", ",", 
     "\[Rho]E"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"V", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.580576402390936*^9, 3.5805764193734503`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"\[Rho]"},
      {"\[Rho]u"},
      {"\[Rho]v"},
      {"\[Rho]w"},
      {"\[Rho]E"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.58057641973836*^9, 3.580576679456415*^9, 3.580642618303637*^9, 
   3.580642936470146*^9, 3.5806442907086477`*^9, {3.580644774779586*^9, 
   3.580644806730968*^9}, 3.580646858778462*^9}]
}, Open  ]],

Cell["\<\
Nondimensional, primitive state variables from Giles and Medida chapter 5 \
expressed using V.\
\>", "Text",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.580642349925385*^9, 3.5806424176023083`*^9}, {3.580642466977564*^9, 
  3.580642471696858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", 
     RowBox[{"\[Rho]u", "/", "\[Rho]"}], ",", 
     RowBox[{"\[Rho]v", "/", "\[Rho]"}], ",", 
     RowBox[{"\[Rho]w", "/", "\[Rho]"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"\[Gamma]", "-", "1"}], 
        SuperscriptBox["Ma", "2"]], "\[Rho]E"}], " ", "+", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", "\[Gamma]"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Rho]u", "2"], "\[Rho]"], "+", 
         FractionBox[
          SuperscriptBox["\[Rho]v", "2"], "\[Rho]"], "+", 
         FractionBox[
          SuperscriptBox["\[Rho]w", "2"], "\[Rho]"]}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.580576323808498*^9, 3.580576395600528*^9}, {
  3.580576658928672*^9, 3.580576664111253*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"\[Rho]"},
      {
       FractionBox["\[Rho]u", "\[Rho]"]},
      {
       FractionBox["\[Rho]v", "\[Rho]"]},
      {
       FractionBox["\[Rho]w", "\[Rho]"]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", "\[Rho]E"}], 
         SuperscriptBox["Ma", "2"]], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Gamma]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["\[Rho]u", "2"], "\[Rho]"], "+", 
           FractionBox[
            SuperscriptBox["\[Rho]v", "2"], "\[Rho]"], "+", 
           FractionBox[
            SuperscriptBox["\[Rho]w", "2"], "\[Rho]"]}], ")"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.580576396040619*^9, 3.5805766794132557`*^9, 3.580642618448992*^9, 
   3.580642936506052*^9, 3.5806442907438383`*^9, {3.580644774786117*^9, 
   3.580644806737668*^9}, 3.5806468587851963`*^9}]
}, Open  ]],

Cell["\<\
Compute the Jacobian matrix mapping from conservative to primitive\
\>", "Text",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.580642349925385*^9, 3.580642458657035*^9}, {3.580642495809059*^9, 
  3.58064251235186*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"U", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"V", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "U", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "V", "]"}]}], "}"}]}], "]"}], "//", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"%", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]u", "\[Rule]", 
         RowBox[{"\[Rho]", " ", "u"}]}], ",", " ", 
        RowBox[{"\[Rho]v", "\[Rule]", 
         RowBox[{"\[Rho]", " ", "v"}]}], ",", 
        RowBox[{"\[Rho]w", "\[Rule]", 
         RowBox[{"\[Rho]", " ", "w"}]}]}], "}"}]}], "//", "FullSimplify"}], "//",
     "Factor"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.580576462727865*^9, 3.580576545419681*^9}, {
  3.580576577869647*^9, 3.580576641161264*^9}, {3.580576673308522*^9, 
  3.580576674172011*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["\[Rho]u", 
        SuperscriptBox["\[Rho]", "2"]]}], 
      FractionBox["1", "\[Rho]"], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["\[Rho]v", 
        SuperscriptBox["\[Rho]", "2"]]}], "0", 
      FractionBox["1", "\[Rho]"], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["\[Rho]w", 
        SuperscriptBox["\[Rho]", "2"]]}], "0", "0", 
      FractionBox["1", "\[Rho]"], "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]u", "2"], "+", 
          SuperscriptBox["\[Rho]v", "2"], "+", 
          SuperscriptBox["\[Rho]w", "2"]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Rho]", "2"]}]], 
      FractionBox[
       RowBox[{"\[Rho]u", "-", 
        RowBox[{"\[Gamma]", " ", "\[Rho]u"}]}], "\[Rho]"], 
      FractionBox[
       RowBox[{"\[Rho]v", "-", 
        RowBox[{"\[Gamma]", " ", "\[Rho]v"}]}], "\[Rho]"], 
      FractionBox[
       RowBox[{"\[Rho]w", "-", 
        RowBox[{"\[Gamma]", " ", "\[Rho]w"}]}], "\[Rho]"], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Gamma]"}], 
       SuperscriptBox["Ma", "2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5805765110974627`*^9, 3.5805765156255417`*^9}, 
   3.5805765457475567`*^9, {3.580576579917173*^9, 3.580576641599675*^9}, {
   3.5805766755958548`*^9, 3.580576679462792*^9}, 3.580642618576817*^9, 
   3.580642936513404*^9, 3.580644290825239*^9, {3.5806447748382072`*^9, 
   3.580644806744792*^9}, 3.580646858792713*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["u", "\[Rho]"]}], 
      FractionBox["1", "\[Rho]"], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["v", "\[Rho]"]}], "0", 
      FractionBox["1", "\[Rho]"], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["w", "\[Rho]"]}], "0", "0", 
      FractionBox["1", "\[Rho]"], "0"},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "u"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "v"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "w"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Gamma]"}], 
       SuperscriptBox["Ma", "2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5805765110974627`*^9, 3.5805765156255417`*^9}, 
   3.5805765457475567`*^9, {3.580576579917173*^9, 3.580576641599675*^9}, {
   3.5805766755958548`*^9, 3.580576679462792*^9}, 3.580642618576817*^9, 
   3.580642936513404*^9, 3.580644290825239*^9, {3.5806447748382072`*^9, 
   3.580644806744792*^9}, 3.580646858795321*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Det", "[", "S", "]"}]], "Input",
 CellChangeTimes->{{3.580582605188401*^9, 3.580582607505207*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "\[Gamma]"}], 
  RowBox[{
   SuperscriptBox["Ma", "2"], " ", 
   SuperscriptBox["\[Rho]", "3"]}]]], "Output",
 CellChangeTimes->{
  3.5805826079355907`*^9, 3.580642618647325*^9, 3.580642936523704*^9, 
   3.580644290907668*^9, {3.5806447748471937`*^9, 3.5806448067531023`*^9}, 
   3.580646858801882*^9}]
}, Open  ]],

Cell["\<\
Find the inverse mapping from primitive back to conservative\
\>", "Text",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.580642349925385*^9, 3.580642458657035*^9}, {3.580642495809059*^9, 
  3.580642536655308*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"invS", " ", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "S", "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.580576685454939*^9, 3.5805766958137627`*^9}, {
  3.5806464077887983`*^9, 3.580646415275165*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {"u", "\[Rho]", "0", "0", "0"},
     {"v", "0", "\[Rho]", "0", "0"},
     {"w", "0", "0", "\[Rho]", "0"},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["Ma", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["Ma", "2"], " ", "u", " ", "\[Rho]"}], 
      RowBox[{
       SuperscriptBox["Ma", "2"], " ", "v", " ", "\[Rho]"}], 
      RowBox[{
       SuperscriptBox["Ma", "2"], " ", "w", " ", "\[Rho]"}], 
      FractionBox[
       SuperscriptBox["Ma", "2"], 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Gamma]"}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.580576687399652*^9, 3.580576696244483*^9}, 
   3.580642618692729*^9, 3.5806429365557413`*^9, 3.580644290954101*^9, {
   3.5806447748990183`*^9, 3.580644806808023*^9}, 3.5806464159248543`*^9, 
   3.580646858859646*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Sanity check via the linearized evolution equation\
\>", "Subsection",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.5806423084853277`*^9, 3.580642331507161*^9}, {3.580642488305594*^9, 
  3.580642489088316*^9}, {3.5806426710861607`*^9, 3.5806426773878813`*^9}, {
  3.580642710348199*^9, 3.580642722187889*^9}, {3.580643510538381*^9, 
  3.580643521769823*^9}, {3.580644333480199*^9, 3.5806443362150908`*^9}}],

Cell[TextData[{
 "3D Euler system in the above variables is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], "U"}], "+", 
     RowBox[{"A", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "U"}]}], "+", 
     RowBox[{"B", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "U"}]}], "+", 
     RowBox[{"C", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "U"}]}]}], "=", "0"}], 
   TraditionalForm]]],
 ".\nRewritten using the identity that \[Gamma] p = \[Rho] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["a", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.4845945823242807`*^9, 3.484594622874104*^9}, 
   3.484596851411501*^9, {3.484915739529868*^9, 3.4849157650243063`*^9}, {
   3.4856121441529837`*^9, 3.48561216799126*^9}, {3.485702663790468*^9, 
   3.4857026826365337`*^9}, {3.48570274246169*^9, 3.485702744450117*^9}, {
   3.486213228840351*^9, 3.4862132360618143`*^9}, {3.4862230151237907`*^9, 
   3.48622301783055*^9}, {3.487441541572253*^9, 3.487441584143311*^9}, 
   3.512312676965309*^9, {3.51231352285052*^9, 3.512313531334841*^9}, {
   3.5123171411277447`*^9, 3.512317145455648*^9}, {3.5164697887655983`*^9, 
   3.5164697925311265`*^9}, {3.5179391955797596`*^9, 3.5179392093294077`*^9}, 
   3.570208918853937*^9, {3.5804734683371468`*^9, 3.5804734845428877`*^9}, 
   3.5804879441560497`*^9, {3.580643588098469*^9, 3.580643637847369*^9}, {
   3.5806436819437532`*^9, 3.580643696663953*^9}, {3.5806555176309834`*^9, 
   3.580655518045628*^9}, {3.580655628861618*^9, 3.580655662828169*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"(", GridBox[{
      {"u", "\[Rho]", "0", "0", "0"},
      {"0", "u", "0", "0", 
       RowBox[{"1", "/", "\[Rho]"}]},
      {"0", "0", "u", "0", "0"},
      {"0", 
       RowBox[{"0", " "}], "0", "u", "0"},
      {"0", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox["a", "2"]}], "0", "0", "u"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"(", GridBox[{
      {"v", "0", "\[Rho]", "0", "0"},
      {"0", "v", "0", "0", "0"},
      {"0", "0", "v", "0", 
       RowBox[{"1", "/", "\[Rho]"}]},
      {"0", 
       RowBox[{"0", " "}], "0", "v", "0"},
      {"0", "0", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox["a", "2"]}], "0", "v"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C", "=", 
   RowBox[{"(", GridBox[{
      {"w", "0", "0", "0", "\[Rho]"},
      {"0", "w", "0", "0", "0"},
      {"0", "0", "w", "0", "0"},
      {"0", 
       RowBox[{"0", " "}], "0", "w", 
       RowBox[{"1", "/", "\[Rho]"}]},
      {"0", "0", "0", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox["a", "2"]}], "w"}
     }], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.580643655581213*^9, 3.580643745469372*^9}, {
  3.580643910147293*^9, 3.580643915316867*^9}, {3.5806442313725967`*^9, 
  3.580644277832312*^9}, {3.580648196592197*^9, 3.580648199593792*^9}, {
  3.5806482909623833`*^9, 3.5806483077590714`*^9}, {3.580648457165306*^9, 
  3.580648469754745*^9}, {3.5806485367472067`*^9, 3.5806485424648*^9}, {
  3.5806555107804127`*^9, 3.580655529529776*^9}, {3.580655580314217*^9, 
  3.5806556186703367`*^9}}],

Cell[TextData[{
 "3D Euler system in the V variables is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], "V"}], "+", 
     RowBox[{"F", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "V"}]}], "+", 
     RowBox[{"G", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "V"}]}], "+", 
     RowBox[{"H", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "V"}]}]}], "=", "0"}], 
   TraditionalForm]]],
 ".\nThis is lifted verbatim from results within \
notebooks/Euler_Eigensystem_3D_PerfectGas.nb and afterwards the eliminate[E] \
identity is applied."
}], "Text",
 CellChangeTimes->{{3.4845945823242807`*^9, 3.484594622874104*^9}, 
   3.484596851411501*^9, {3.484915739529868*^9, 3.4849157650243063`*^9}, {
   3.4856121441529837`*^9, 3.48561216799126*^9}, {3.485702663790468*^9, 
   3.4857026826365337`*^9}, {3.48570274246169*^9, 3.485702744450117*^9}, {
   3.486213228840351*^9, 3.4862132360618143`*^9}, {3.4862230151237907`*^9, 
   3.48622301783055*^9}, {3.487441541572253*^9, 3.487441584143311*^9}, 
   3.512312676965309*^9, {3.51231352285052*^9, 3.512313531334841*^9}, {
   3.5123171411277447`*^9, 3.512317145455648*^9}, {3.5164697887655983`*^9, 
   3.5164697925311265`*^9}, {3.5179391955797596`*^9, 3.5179392093294077`*^9}, 
   3.570208918853937*^9, {3.5804734683371468`*^9, 3.5804734845428877`*^9}, 
   3.5804879441560497`*^9, {3.580643588098469*^9, 3.580643637847369*^9}, {
   3.5806436819437532`*^9, 3.580643696663953*^9}, {3.580644324059828*^9, 
   3.580644405557235*^9}, {3.5806447400791817`*^9, 3.5806447493575583`*^9}, {
   3.580644814351812*^9, 3.5806448247164803`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"F", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0"},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["u", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["v", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "u"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{"v", "-", 
         RowBox[{"v", " ", "\[Gamma]"}]}], 
        RowBox[{"w", "-", 
         RowBox[{"w", " ", "\[Gamma]"}]}], 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Gamma]"}], 
         SuperscriptBox["Ma", "2"]]},
       {
        RowBox[{
         RowBox[{"-", "u"}], " ", "v"}], "v", "u", "0", "0"},
       {
        RowBox[{
         RowBox[{"-", "u"}], " ", "w"}], "w", "0", "u", "0"},
       {
        RowBox[{"u", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["Ma", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["u", "2"], "+", 
              SuperscriptBox["v", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "-", 
           RowBox[{"E", " ", "\[Gamma]"}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["Ma", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox["u", "2"]}], "+", 
              SuperscriptBox["v", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{"2", " ", "E", " ", "\[Gamma]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["Ma", "2"]}], " ", "u", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["Ma", "2"]}], " ", "u", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{"u", " ", "\[Gamma]"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], ";"}]], "Input",
 FontSize->10],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0", "0"},
       {
        RowBox[{
         RowBox[{"-", "u"}], " ", "v"}], "v", "u", "0", "0"},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["v", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["u", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["w", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}]}], ")"}]}], 
        RowBox[{"u", "-", 
         RowBox[{"u", " ", "\[Gamma]"}]}], 
        RowBox[{
         RowBox[{"-", "v"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{"w", "-", 
         RowBox[{"w", " ", "\[Gamma]"}]}], 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Gamma]"}], 
         SuperscriptBox["Ma", "2"]]},
       {
        RowBox[{
         RowBox[{"-", "v"}], " ", "w"}], "0", "w", "v", "0"},
       {
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["Ma", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["u", "2"], "+", 
              SuperscriptBox["v", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "-", 
           RowBox[{"E", " ", "\[Gamma]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["Ma", "2"]}], " ", "u", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["Ma", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["u", "2"], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["v", "2"]}], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{"2", " ", "E", " ", "\[Gamma]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["Ma", "2"]}], " ", "v", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{"v", " ", "\[Gamma]"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.58064446672465*^9, 3.58064446858357*^9}},
 FontSize->10],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "1", "0"},
       {
        RowBox[{
         RowBox[{"-", "u"}], " ", "w"}], "w", "0", "u", "0"},
       {
        RowBox[{
         RowBox[{"-", "v"}], " ", "w"}], "0", "w", "v", "0"},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["w", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["u", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}]}], ")"}]}], 
        RowBox[{"u", "-", 
         RowBox[{"u", " ", "\[Gamma]"}]}], 
        RowBox[{"v", "-", 
         RowBox[{"v", " ", "\[Gamma]"}]}], 
        RowBox[{
         RowBox[{"-", "w"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "\[Gamma]"}], ")"}]}], 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Gamma]"}], 
         SuperscriptBox["Ma", "2"]]},
       {
        RowBox[{"w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["Ma", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["u", "2"], "+", 
              SuperscriptBox["v", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "-", 
           RowBox[{"E", " ", "\[Gamma]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["Ma", "2"]}], " ", "u", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["Ma", "2"]}], " ", "v", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["Ma", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["u", "2"], "+", 
              SuperscriptBox["v", "2"], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["w", "2"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "+", 
           RowBox[{"2", " ", "E", " ", "\[Gamma]"}]}], ")"}]}], 
        RowBox[{"w", " ", "\[Gamma]"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.5806444794115143`*^9, 3.580644481048246*^9}},
 FontSize->10],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"F", ",", "G", ",", "H"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"F", ",", "G", ",", "H"}], "}"}], "//.", 
     RowBox[{"E", "\[Rule]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["Ma", "2"], 
        FractionBox[
         RowBox[{
          SuperscriptBox["u", "2"], "+", 
          SuperscriptBox["v", "2"], "+", 
          SuperscriptBox["w", "2"]}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "\[Gamma]"], 
        FractionBox[
         SuperscriptBox["a", "2"], 
         RowBox[{"\[Gamma]", "-", "1"}]]}]}]}]}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5806444424503727`*^9, 3.58064444417876*^9}, {
   3.5806445273790207`*^9, 3.580644597003961*^9}, {3.5806446270985947`*^9, 
   3.580644714357524*^9}, 3.580644782341855*^9}],

Cell[TextData[{
 "It should be the case that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["S", 
      RowBox[{"-", "1"}]], "A", " ", "S"}], " ", "=", " ", "F"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", etc."
}], "Text",
 CellChangeTimes->{{3.4845945823242807`*^9, 3.484594622874104*^9}, 
   3.484596851411501*^9, {3.484915739529868*^9, 3.4849157650243063`*^9}, {
   3.4856121441529837`*^9, 3.48561216799126*^9}, {3.485702663790468*^9, 
   3.4857026826365337`*^9}, {3.48570274246169*^9, 3.485702744450117*^9}, {
   3.486213228840351*^9, 3.4862132360618143`*^9}, {3.4862230151237907`*^9, 
   3.48622301783055*^9}, {3.487441541572253*^9, 3.487441584143311*^9}, 
   3.512312676965309*^9, {3.51231352285052*^9, 3.512313531334841*^9}, {
   3.5123171411277447`*^9, 3.512317145455648*^9}, {3.5164697887655983`*^9, 
   3.5164697925311265`*^9}, {3.5179391955797596`*^9, 3.5179392093294077`*^9}, 
   3.570208918853937*^9, {3.5804734683371468`*^9, 3.5804734845428877`*^9}, 
   3.5804879441560497`*^9, {3.580643588098469*^9, 3.580643637847369*^9}, {
   3.5806436819437532`*^9, 3.580643696663953*^9}, {3.580644324059828*^9, 
   3.580644405557235*^9}, {3.5806447400791817`*^9, 3.5806447493575583`*^9}, {
   3.580644814351812*^9, 3.5806448247164803`*^9}, {3.580646032946348*^9, 
   3.580646099297071*^9}, {3.5806463785069532`*^9, 3.580646380634129*^9}}],

Cell[TextData[StyleBox["BEGIN FIXME DANGER FIXME DANGER FIXME",
 FontWeight->"Bold",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.580648589286458*^9, 3.580648595736951*^9}, {
  3.580648645128131*^9, 3.5806486637176113`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F", "-", 
    RowBox[{"invS", ".", 
     RowBox[{"(", 
      RowBox[{"A", "/.", 
       RowBox[{"a", "\[Rule]", 
        FractionBox["a", "Ma"]}]}], ")"}], ".", "S"}]}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.580646383071686*^9, 3.5806464343940496`*^9}, {
  3.580646791603498*^9, 3.580646836049918*^9}, {3.580646893281075*^9, 
  3.580646894097395*^9}, {3.580648242611272*^9, 3.580648252866095*^9}, {
  3.580648546589229*^9, 3.580648550061158*^9}, {3.5806538882779913`*^9, 
  3.580653889397142*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "u"}], "1", "0", "0", "0"},
     {
      RowBox[{"-", 
       SuperscriptBox["u", "2"]}], "u", "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", "u"}], " ", "v"}], "v", "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", "u"}], " ", "w"}], "w", "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox["Ma", "2"], " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["Ma", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5806463853374653`*^9, 3.580646435804092*^9}, {
   3.580646797201158*^9, 3.5806468055726213`*^9}, {3.580646836640583*^9, 
   3.5806468589600687`*^9}, 3.580646895002623*^9, 3.5806482132749987`*^9, {
   3.5806482480401773`*^9, 3.580648253311779*^9}, 3.5806483110341253`*^9, 
   3.580648475131095*^9, 3.580648578424938*^9, {3.5806539088105373`*^9, 
   3.5806539414094467`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"G", "-", 
    RowBox[{"invS", ".", 
     RowBox[{"(", 
      RowBox[{"B", "/.", 
       RowBox[{"a", "\[Rule]", 
        FractionBox["a", "Ma"]}]}], ")"}], ".", "S"}]}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.580646383071686*^9, 3.5806464343940496`*^9}, {
  3.580646791603498*^9, 3.58064685355282*^9}, {3.580646898176811*^9, 
  3.5806468983843927`*^9}, {3.5806485542037487`*^9, 3.5806485695326242`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "v"}], "0", "1", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", "u"}], " ", "v"}], "0", "u", "0", "0"},
     {
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "0", "v", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", "v"}], " ", "w"}], "0", "w", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox["Ma", "2"], " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["Ma", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.580646859033082*^9, 3.580646899330525*^9, 
  3.580648222640678*^9, 3.580648477930982*^9, 3.5806485807604856`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H", "-", 
    RowBox[{"invS", ".", 
     RowBox[{"(", 
      RowBox[{"C", "/.", 
       RowBox[{"a", "\[Rule]", 
        FractionBox["a", "Ma"]}]}], ")"}], ".", "S"}]}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.580646383071686*^9, 3.5806464343940496`*^9}, {
  3.580646791603498*^9, 3.5806468572173147`*^9}, {3.580646902336883*^9, 
  3.580646902624299*^9}, {3.580648561020666*^9, 3.5806485709414263`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "w"}], "0", "0", "1", "0"},
     {
      RowBox[{
       RowBox[{"-", "u"}], " ", "w"}], "0", "0", "u", "0"},
     {
      RowBox[{
       RowBox[{"-", "v"}], " ", "w"}], "0", "0", "v", "0"},
     {
      RowBox[{"-", 
       SuperscriptBox["w", "2"]}], "0", "0", "w", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox["Ma", "2"], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], "0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["Ma", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "+", 
         SuperscriptBox["v", "2"], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.580646859159358*^9, 3.58064690344293*^9, 
  3.580648225760765*^9, 3.5806484805388727`*^9, 3.580648583102097*^9}]
}, Open  ]],

Cell[TextData[StyleBox["END FIXME DANGER FIXME DANGER FIXME",
 FontWeight->"Bold",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.580648589286458*^9, 3.580648595736951*^9}, {
  3.580648645128131*^9, 3.580648670357621*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Medida\[CloseCurlyQuote]s boundary condition matrices\
\>", "Subsection",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.5806423084853277`*^9, 3.580642331507161*^9}, {3.580642488305594*^9, 
  3.580642489088316*^9}, {3.5806426710861607`*^9, 3.5806426773878813`*^9}, {
  3.580642710348199*^9, 3.580642722187889*^9}, {3.580643504442358*^9, 
  3.5806435074335527`*^9}}],

Cell["\<\
These are supposed to be nondimensionalized to account for a Mach number.
But, it remains to be confirmed that the behavior is correct!\
\>", "Text",
 CellChangeTimes->{{3.546010803909782*^9, 3.546010821934022*^9}, {
  3.580642349925385*^9, 3.580642458657035*^9}, {3.580642495809059*^9, 
  3.580642536655308*^9}, {3.580642750891264*^9, 3.580642774809832*^9}, {
  3.580642878584886*^9, 3.580642887431511*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VL", "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         SuperscriptBox["a", "2"]}], "0", "0", "0", "1"},
       {"0", "0", 
        RowBox[{"\[Rho]", " ", "a"}], "0", "0"},
       {"0", "0", "0", 
        RowBox[{"\[Rho]", " ", "a"}], "0"},
       {"0", 
        RowBox[{"\[Rho]", " ", "a"}], "0", "0", "1"},
       {"0", 
        RowBox[{
         RowBox[{"-", "\[Rho]"}], " ", "a"}], "0", "0", "1"}
      }], ")"}], "/.", 
    RowBox[{"a", "\[Rule]", 
     FractionBox["a", "Ma"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1G", "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {"0", "0", "0", "0", "0"},
       {"0", "v", "0", 
        FractionBox[
         RowBox[{"a", "+", "u"}], "2"], 
        FractionBox[
         RowBox[{"a", "-", "u"}], "2"]},
       {"0", "0", "v", "0", "0"},
       {"0", 
        FractionBox[
         RowBox[{"a", "-", "u"}], "2"], "0", "v", "0"},
       {"0", "u", "0", "0", "v"}
      }], ")"}], "/.", 
    RowBox[{"a", "\[Rule]", 
     FractionBox["a", "Ma"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1G", "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {"0", "0", "0", "0", "0"},
       {"0", "w", "0", "0", "0"},
       {"0", "0", "w", 
        FractionBox[
         RowBox[{"a", "+", "u"}], "2"], 
        FractionBox[
         RowBox[{"a", "-", "u"}], "2"]},
       {"0", "0", 
        FractionBox[
         RowBox[{"a", "-", "u"}], "2"], "w", "0"},
       {"0", "0", "u", "0", "w"}
      }], ")"}], "/.", 
    RowBox[{"a", "\[Rule]", 
     FractionBox["a", "Ma"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.545758492441104*^9, 3.5457586341732607`*^9}, {
  3.545758670926149*^9, 3.545758846126648*^9}, {3.545998442283105*^9, 
  3.5459985218097143`*^9}, {3.5460048861247597`*^9, 3.546004898298379*^9}, {
  3.546010526958501*^9, 3.546010532692361*^9}, {3.546779064174736*^9, 
  3.546779071231304*^9}, {3.546779769479422*^9, 3.54677977404285*^9}, {
  3.54678109202411*^9, 3.5467810949500513`*^9}, {3.546781162159437*^9, 
  3.546781177253854*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Det", "[", "VL", "]"}]], "Input",
 CellChangeTimes->{{3.546001791306635*^9, 3.546001794251507*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["a", "5"], " ", 
    SuperscriptBox["\[Rho]", "3"]}], 
   SuperscriptBox["Ma", "5"]]}]], "Output",
 CellChangeTimes->{
  3.580642936612973*^9, 3.580644290998109*^9, {3.580644775936521*^9, 
   3.580644806926921*^9}, 3.580646859169104*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"B2G", "=", "B1G"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B2G", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"a", "+", "u"}], "2"], "/.", 
      RowBox[{"a", "\[Rule]", 
       FractionBox["a", "Ma"]}]}], ",", "0", ",", "0", ",", "v"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "B2G", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2G", "=", "C1G"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C2G", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"a", "+", "u"}], "2"], "/.", 
      RowBox[{"a", "\[Rule]", 
       FractionBox["a", "Ma"]}]}], ",", "0", ",", "w"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "C2G", "]"}]}], "Input",
 CellChangeTimes->{{3.54599851915975*^9, 3.545998530443953*^9}, {
  3.5467810993329906`*^9, 3.5467811074604177`*^9}, {3.546781187860372*^9, 
  3.546781190221862*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0"},
     {"0", "v", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "+", "u"}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "-", "u"}], ")"}]}]},
     {"0", "0", "v", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "-", "u"}], ")"}]}], "0", "v", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "+", "u"}], ")"}]}], "0", "0", "v"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.58064293664986*^9, 3.58064429100518*^9, {3.5806447760114594`*^9, 
   3.580644806934276*^9}, 3.580646859175387*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0"},
     {"0", "w", "0", "0", "0"},
     {"0", "0", "w", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "+", "u"}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "-", "u"}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "-", "u"}], ")"}]}], "w", "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["a", "Ma"], "+", "u"}], ")"}]}], "0", "w"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.58064293664986*^9, 3.58064429100518*^9, {3.5806447760114594`*^9, 
   3.580644806934276*^9}, 3.580646859177474*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{958, 1198},
WindowMargins->{{Automatic, -958}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 261, 5, 72, "Section"],
Cell[843, 29, 293, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[1161, 38, 1123, 26, 240, "Input"],
Cell[CellGroupData[{
Cell[2309, 68, 464, 8, 22, "Print"],
Cell[2776, 78, 481, 9, 22, "Print"]
}, Open  ]],
Cell[3272, 90, 555, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3864, 109, 280, 5, 37, "Subsection"],
Cell[4147, 116, 200, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[4372, 124, 316, 8, 50, "Input"],
Cell[4691, 134, 905, 26, 100, "Output"]
}, Open  ]],
Cell[5611, 163, 284, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[5920, 173, 963, 27, 80, "Input"],
Cell[6886, 202, 1649, 48, 161, "Output"]
}, Open  ]],
Cell[8550, 253, 253, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[8828, 262, 1302, 36, 88, "Input"],
Cell[10133, 300, 2231, 62, 172, "Output"],
Cell[12367, 364, 2143, 63, 159, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14547, 432, 122, 2, 30, "Input"],
Cell[14672, 436, 369, 10, 56, "Output"]
}, Open  ]],
Cell[15056, 449, 248, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[15329, 458, 331, 8, 50, "Input"],
Cell[15663, 468, 1549, 42, 119, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17261, 516, 442, 7, 38, "Subsection"],
Cell[17706, 525, 1635, 37, 53, "Text"],
Cell[19344, 564, 1645, 46, 277, "Input"],
Cell[20992, 612, 1662, 35, 53, "Text"],
Cell[22657, 649, 3410, 101, 107, "Input"],
Cell[26070, 752, 3551, 104, 107, InheritFromParent],
Cell[29624, 858, 3555, 104, 107, InheritFromParent],
Cell[33182, 964, 876, 26, 59, "Input"],
Cell[34061, 992, 1387, 26, 30, "Text"],
Cell[35451, 1020, 242, 4, 29, "Text"],
Cell[CellGroupData[{
Cell[35718, 1028, 588, 14, 52, "Input"],
Cell[36309, 1044, 1820, 50, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38166, 1099, 493, 12, 52, "Input"],
Cell[38662, 1113, 1559, 46, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40258, 1164, 492, 12, 52, "Input"],
Cell[40753, 1178, 1558, 46, 116, "Output"]
}, Open  ]],
Cell[42326, 1227, 238, 4, 29, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42601, 1236, 399, 7, 38, "Subsection"],
Cell[43003, 1245, 418, 7, 49, "Text"],
Cell[43424, 1254, 2096, 62, 319, "Input"],
Cell[CellGroupData[{
Cell[45545, 1320, 123, 2, 30, "Input"],
Cell[45671, 1324, 322, 9, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46030, 1338, 1164, 31, 174, "Input"],
Cell[47197, 1371, 1406, 43, 139, "Output"],
Cell[48606, 1416, 1406, 43, 139, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
