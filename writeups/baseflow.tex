\documentclass[letterpaper,11pt,nointlimits,reqno]{amsart}

% Packages
\usepackage{accents}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{cancel}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage{fullpage}
\usepackage{ifthen}
\usepackage{lastpage}
\usepackage{latexsym}
\usepackage{listings}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage[numbers,sort&compress]{natbib}
\usepackage{parskip}
\usepackage{pstricks}
\usepackage{setspace}

% Hyperref package must be last otherwise the contents are jumbled
% hypertexnames disabled to fix links pointing to incorrect locations
\usepackage[hypertexnames=false,final]{hyperref}

\mathtoolsset{showonlyrefs,showmanualtags}
\allowdisplaybreaks[1] % Allow grouped equations to be split across pages

% Line Spacing
\singlespacing

% Set appropriate header/footer information on each page
\fancypagestyle{plain}{
    \fancyhf{}
    \renewcommand{\headheight}{2.0em}
    \renewcommand{\headsep}{0.75em}
    \renewcommand{\headrulewidth}{1.0pt}
    \renewcommand{\footrulewidth}{0pt}
    \lhead{
        Favorable pressure gradient base flow computations
    }
    \rhead{
        Page \thepage{} of \pageref{LastPage}
    }
}
\pagestyle{plain}

% Document-specific commands
\newcommand{\Mach}[1][]{\ensuremath{\mbox{Ma}_{#1}}}

\begin{document}

This document discusses how to obtain a favorable pressure gradient base flow
for use within temporally-homogenized boundary layer simulations.  First, a
compressible potential flow problem is formulated for a radially-symmetric
source or sink flow.  The boundary conditions are taken to match some
freestream state of interest.  Next, the resulting one-dimensional problem is
numerically solved using \texttt{Chebfun} by \citet{chebfunv4} and the solution
transformed into conserved variables.  Finally, the conserved state is mapped
onto the first quadrant of a Cartesian domain with state and derivatives
collected from rays oriented in the positive $y$ direction.

\section{The nondimensional, radially-symmetric compressible potential flow equation}

A particularly crisp derivation of the coordinate-independent,
velocity-potential formulation for the compressible potential flow equations
appears in section II.A of \citet{Saad2011Coordinate}.  Decomposing the
dimensional velocity $\vec{u}$ into a scalar and vector potential and assuming
that the flow is irrotational,
\begin{align}
  \vec{u} &= \vec{\nabla}\phi + \vec{\nabla}\times\vec{A} =  \vec{\nabla}\phi
.
\end{align}
Inserting the scalar potential into the continuity equation and assuming
smoothness,
\begin{align}
  0 &= \vec{\nabla}\cdot\rho\vec{u}
     = \vec{\nabla}\cdot\rho\vec{\nabla}\phi
     = \rho\vec{\nabla}^2\phi
     + \vec{\nabla}\rho\cdot\vec{\nabla}\phi
.
\end{align}
From the definition of the speed of sound $a$ notice
\begin{align}
    \frac{\mathrm{d}p}{\mathrm{d}\rho} = a^2
    &\implies
    \vec{\nabla}\rho = \frac{1}{a^2} \vec{\nabla} p
.
\end{align}
In a steady, inviscid, irrotational context the momentum equation yields
\begin{align}
    \vec{\nabla}p
    &= -\rho \vec{u}\cdot\vec{\nabla}\vec{u}
     = -\rho \left(   \frac{1}{2}\vec{\nabla}\vec{u}^2
                    - \vec{u}\times\vec{\nabla}\times\vec{u}
        \right)
     = - \frac{1}{2} \rho \vec{\nabla}\vec{u}^2
.
\end{align}
Rearranging the continuity result followed by two straightforward substitutions
shows
\begin{align}
    \vec{\nabla}^2\phi
    &= -\vec{\nabla}\phi\cdot\frac{1}{\rho}\vec{\nabla}\rho
     = -\vec{\nabla}\phi\cdot\frac{1}{\rho{}a^2}\vec{\nabla}p
     =  \vec{\nabla}\phi\cdot\frac{1}{2a^2} \vec{\nabla}\vec{u}^2
.
\end{align}
Moving the denominator to the left hand side and inserting the scalar
potential,
\begin{align}
    2 a^2 \vec{\nabla}^2\phi
    &= \vec{\nabla}\phi\cdot \vec{\nabla}\vec{u}^2
     = \vec{\nabla}\phi\cdot \vec{\nabla}\left(\vec{\nabla}\phi\right)^2
\label{eq:cpfgibbs_nothermo_dim}
.
\end{align}

Next, \citeauthor{Saad2011Coordinate} employ that stagnation energy stays
constant throughout such a flow to connect the local speed of sound to
reference parameters and the local velocity.  That is, for flow enthalpy $h =
a^2 / \left(\gamma-1\right)$, reference enthalpy $h_0 = a_0^2 /
\left(\gamma_0-1\right)$, and reference velocity $\vec{u}_0$
\begin{align}
        \frac{a^2  }{\gamma  -1} + \frac{1}{2} \vec{u}^2
     &= \frac{a_0^2}{\gamma_0-1} + \frac{1}{2} \vec{u}_0^2
\end{align}
holds everywhere. From this energy constraint
\begin{align}
        2a^2
     &=   2a_0^2 \frac{\gamma-1}{\gamma_0-1}
        + \left(\gamma-1\right)\vec{u}_0^2
        - \left(\gamma-1\right)\vec{u}^2
\end{align}
may be used within~\eqref{eq:cpfgibbs_nothermo_dim} to produce
\begin{align}
    \left[
          2a_0^2 \frac{\gamma-1}{\gamma_0-1}
        + \left(\gamma-1\right)
          \left(\vec{u}_0^2 - \left(\vec{\nabla}\phi\right)^2\right)
    \right] \vec{\nabla}^2\phi
     = \vec{\nabla}\phi\cdot \vec{\nabla}\left(\vec{\nabla}\phi\right)^2
\label{eq:cpfgibbs_dim}
.
\end{align}

To nondimensionalize, chose some reference length $l_0$ and declare
\begin{align}
    x     &= x^\ast l_0
&   u     &= u^\ast u_0
&   a     &= a^\ast a_0
&   \phi  &= \phi^\ast u_0 l_0
&   \rho  &= \rho^\ast \rho_0
&   p     &= p^\ast \rho_0 a_0^2
\end{align}
where starred quantities are dimensionless.  Inserting these definitions
into~\eqref{eq:cpfgibbs_dim},
\begin{align}
    \left[
          2a_0^2 \frac{\gamma-1}{\gamma_0-1}
        + u_0^2 \left(\gamma-1\right)
          \left(1 - \left(\vec{\nabla}^\ast\phi^\ast\right)^2\right)
    \right] \frac{u_0}{l_0} {\vec{\nabla}^\ast}^2\phi^\ast
     =       \frac{u_0^3}{l_0} \vec{\nabla}^\ast\phi^\ast
       \cdot \vec{\nabla}^\ast\left(\vec{\nabla}^\ast\phi^\ast\right)^2
.
\end{align}
Multiplying through by $\frac{l_0}{a_0^2 u_0}$, identifying $\Mach =
\frac{u_0}{a_0}$, and dropping the star notation,
\begin{align}
    \left[
          2 \frac{\gamma-1}{\gamma_0-1}
        + \Mach^2 \left(\gamma-1\right)
          \left(1 - \left(\vec{\nabla}\phi\right)^2\right)
    \right] {\vec{\nabla}}^2\phi
     =       \Mach^2 \vec{\nabla}\phi
       \cdot \vec{\nabla}\left(\vec{\nabla}\phi\right)^2
.
\end{align}
Moving the $\Mach^2$ term to the right hand side, rescaling, and distributing,
\begin{align}
       {\vec{\nabla}}^2\phi
    &= \frac{\Mach^2}{2}\frac{\gamma_0-1}{\gamma-1} \left(
         \vec{\nabla}\phi \cdot \vec{\nabla}\left(\vec{\nabla}\phi\right)^2
       +
       \left[
             \left(\gamma-1\right)
             \left(\left(\vec{\nabla}\phi\right)^2 - 1\right)
       \right] {\vec{\nabla}}^2\phi
       \right)
\\  &= \frac{\Mach^2}{2} \left(
         \frac{\gamma_0-1}{\gamma-1}
         \vec{\nabla}\phi \cdot \vec{\nabla}\left(\vec{\nabla}\phi\right)^2
       +
       \left[
             \left(\gamma_0-1\right)
             \left(\left(\vec{\nabla}\phi\right)^2 - 1\right)
       \right] {\vec{\nabla}}^2\phi
       \right)
.
\end{align}
As \citeauthor{Saad2011Coordinate} implicitly concluded, this formulation is
most useful when $\gamma$ is known or when it can be connected to $\phi$ in
some manner.  Adding a constant $\gamma=\gamma_0$ assumption, one arrives at
\begin{align}
       {\vec{\nabla}}^2\phi
    &=   \frac{1}{2}\Mach^2
         \vec{\nabla}\phi \cdot \vec{\nabla}\left(\vec{\nabla}\phi\right)^2
       +
         \frac{\gamma_0-1}{2}\Mach^2
         \left(\left(\vec{\nabla}\phi\right)^2 - 1\right)
         {\vec{\nabla}}^2\phi
\label{eq:cpfgibbs_nondim}
\end{align}
which is an awfully nonlinear but pleasantly univariate result.

On a radially-symmetric geometry $\phi=\phi\left(r\right)$ only.
\emph{Mathematica}\textregistered{} can translate~\eqref{eq:cpfgibbs_nondim}
into this setting
\begin{lstlisting}[language=Mathematica,
                   columns=flexible,basicstyle={\sffamily},frame={lines}]
    Needs["VectorAnalysis`"];
    SetCoordinates[Cylindrical];
    With[{f=phi[Rr]},
        With[{gf=Simplify[Grad[f]],lf=Simplify[Laplacian[f]]},
            With[{gf2 = Simplify[DotProduct[gf,gf]]},
                lf-(Ma^2/2) DotProduct[gf,Grad[gf2]]-(gamma0-1)(Ma^2/2)(gf2-1)lf
            ]
        ]
    ];
    Collect[%,{phi''[Rr],phi'[Rr],phi[Rr]}];
    Map[Simplify,%]
\end{lstlisting}
producing output equivalent to
\begin{align}
    \frac{2+\Mach^2\left(\gamma_0-1\right)}{2 r}\phi^\prime
   -\frac{  \Mach^2\left(\gamma_0-1\right)}{2 r}{\phi^\prime}^3
   +\frac{1}{2}\left(2+\Mach^2\left(\gamma_0-1\right)
                      -\Mach^2\left(\gamma_0+1\right){\phi^\prime}^2\right)
               \phi^{\prime\prime}
   &= 0
.
\end{align}
Rewriting using $u = \phi^\prime(r)$ and multiplying through by $r$ as the
origin will not be of interest,
\begin{align}
    \left(1+\Mach^2\frac{\gamma_0-1}{2}\right) u
   -        \Mach^2\frac{\gamma_0-1}{2}        u^3
   +r\left(1+\Mach^2\frac{\gamma_0-1}{2}
            -\Mach^2\frac{\gamma_0+1}{2}u^2\right)
    u^\prime
   &= 0
.
\end{align}

\newcommand*{\doi}[1]{\href{http://dx.doi.org/\detokenize{#1}}{doi: #1}}
\bibliographystyle{plainnat}
\bibliography{references}

\end{document}
