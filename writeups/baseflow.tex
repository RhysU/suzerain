\documentclass[letterpaper,11pt,nointlimits,reqno]{amsart}
\pagestyle{headings}

% Packages
\usepackage{accents}
\usepackage{array}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage[final]{graphicx}
\usepackage{fullpage}
\usepackage{lastpage}
\usepackage{listings}
\usepackage{longtable}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage[numbers,sort&compress]{natbib}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}

% Avoids xcolor options clashes
\usepackage{pgfplotstable}

% In conjunction with -shell-escape, automatically convert EPS to PDF
\usepackage{epstopdf}
\epstopdfsetup{outdir=./,suffix=-generated,update,verbose}
\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{%
    epstopdf --outfile=\OutputFile \space `kpsewhich \space "\SourceFile"`
}

% Hyperref package must be last otherwise the contents are jumbled
% hypertexnames disabled to fix links pointing to incorrect locations
\usepackage[hypertexnames=false,final]{hyperref}

\mathtoolsset{showonlyrefs,showmanualtags}
% \allowdisplaybreaks[1] % Allow grouped equations to be split across pages

% Document-specific commands
\newcommand{\Mach}[1][]{\mbox{Ma}_{#1}}

% Configure inline code listings
\lstset{
  basicstyle=\footnotesize\sffamily,
  columns=fixed,
  commentstyle=\color{blue},
  firstnumber=1,
  frame=single,
  keepspaces=true,
  numbersep=7pt,
  numbers=left,
  numberstyle=\tiny\color{darkgray},
  showstringspaces=false,
  showtabs=false,
  stepnumber=5
}

\begin{document}

\title{Base flow computations}
\author{Rhys Ulerich}

\begin{abstract}
TODO
\end{abstract}

\maketitle

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The nondimensional, compressible, isenthalpic potential flow equation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

A succinct, coordinate-independent derivation of the velocity-potential
formulation of the compressible, potential isenthalpic flow equations appears
in section II.A of \citet{Saad2011Coordinate}.  Their presentation essentially
is recounted here but in a nondimensional setting with a slightly larger
emphasis on the role of temperature. Wherever necessary, sufficient smoothness
is assumed.

The nondimensional Euler equations governing a steady ideal gas flow may be written
\begin{align}
  \label{eq:continuity}
  0
&=
  - \nabla\cdot\rho{}\vec{u}
  \\
  \label{eq:momentum}
  0
&=
  - \nabla\cdot(\vec{u}\otimes\rho{}\vec{u})
  - \frac{1}{\Mach^{2}} \nabla{} p
  \\
  \label{eq:energy}
  0
&=
  - \nabla\cdot\rho{}H\vec{u}
\end{align}
by defining $\Mach = \frac{u_{0}}{a_{0}}$ along with the following
relationships:
\begin{align}
  \label{eq:eos}
  H &= \frac{a^2}{\gamma-1} + \frac{\Mach^2}{2}\vec{u}^2
     = E + \frac{p}{\rho}
  &
  a^2 &= T
  &
  \rho &= \frac{\gamma{} p}{T}
\end{align}
In an irrotational flow the momentum equation yields
\begin{align}
    \vec{\nabla}p
    &= - \Mach^2 \rho \vec{u}\cdot\vec{\nabla}\vec{u}
     = - \Mach^2 \rho \left(
           \frac{1}{2}\vec{\nabla}\left(\vec{u}\cdot\vec{u}\right)
         - \vec{u}\times\vec{\nabla}\times\vec{u}
        \right)
     = - \frac{\Mach^2}{2} \rho \vec{\nabla}\vec{u}^2.
\label{eq:irrot_momentum}
\end{align}
The irrotational velocity may be replaced by the gradient of a scalar
potential, \emph{viz.}
\begin{align}
  \vec{u} = \vec{\nabla}\phi + \vec{\nabla}\times\vec{A} = \vec{\nabla}{\phi}.
\end{align}
However, velocity potential notation is here suppressed.

Assume now an isenthalpic flow wherein total specific enthalpy $H$ is
everywhere constant. Clearly, in these circumstances, the energy equation
degenerates to the continuity equation and so it merits no further interest.
Rearranging~\eqref{eq:eos},
\begin{align}
  T &= \left(\gamma-1\right)\left(H - \frac{\Mach^2}{2}\vec{u}^2\right),
  \label{eq:T}
\end{align}
followed by differentiating under the assumption $\vec{\nabla}H=0$,
\begin{align}
  \vec{\nabla} T &= -\left(\gamma-1\right)\frac{\Mach^2}{2}\vec{\nabla}\vec{u}^2.
  \label{eq:isen_gradT}
\end{align}
Comparing just above with~\eqref{eq:irrot_momentum}, notice
\begin{align}
  \vec{\nabla}p &= \frac{\rho}{\gamma-1}\vec{\nabla}T.
  \label{irrot_momentum_stag}
\end{align}
Differentiating $\rho$ from~\eqref{eq:eos},
substituting~\eqref{irrot_momentum_stag}, simplifying,
and applying~\eqref{eq:isen_gradT},
\begin{align}
  \vec{\nabla}\rho
  &=
  \frac{\gamma}{T} \vec{\nabla}p
  -
  \frac{\gamma p}{T^2} \vec{\nabla}T
\\&=
  \frac{\gamma}{T} \frac{\rho}{\gamma-1} \vec{\nabla}T
  -
  \frac{\rho}{T} \vec{\nabla}T
\\&=
  \frac{\rho}{T}
  \frac{1}{\gamma-1}
  \vec{\nabla}T
\\&=
  -
  \frac{\rho}{T}
  \frac{\Mach^2}{2}\vec{\nabla}\vec{u}^2.
  \label{eq:rho}
\end{align}
Expanding~\eqref{eq:continuity}, rearranging, and using the prior statement
about $\vec{\nabla}\rho$,
\begin{align}
  \vec{\nabla}\cdot\vec{u}
  &= -\vec{u}\cdot\frac{1}{\rho}\vec{\nabla}\rho
\\
  &= \vec{u}\cdot \frac{\Mach^2}{2T}\vec{\nabla}\vec{u}^2.
\end{align}
Applying~\eqref{eq:T}, one arrives at a velocity equation depending
only on constants $\gamma$, $\Mach$, and $H$,
\begin{align}
  \vec{\nabla}\cdot\vec{u}
  &= \frac{\Mach^2 \vec{u}\cdot \vec{\nabla}\vec{u}^2}
          {\left(\gamma-1\right)\left(2H - \Mach^2 \vec{u}^2\right)}.
  \label{eq:gibbsresult}
\end{align}
This result is a nondimensional analogue of \citeauthor{Saad2011Coordinate}'s
equation~(17).

With some $\vec{u}=\vec{\nabla}\phi$ satisfying~\eqref{eq:gibbsresult} in hand,
computing local $T$, $a$, $p$ and $\rho$ is often of interest.  Temperature $T$
and sound speed $a$ may be computed pointwise from~\eqref{eq:T}
and~\eqref{eq:eos}. The gradient of pressure is implied
by~\eqref{eq:irrot_momentum} while reworking~\eqref{eq:rho} shows
\begin{align}
  \vec{\nabla}\log\rho
  &=
  -\frac{\Mach^2}{2T}\vec{\nabla}\vec{u}^2.
\end{align}
Integral statements may be made about $p$ and $\rho$ by investigating some
domain $\Omega$ and applying a corollary of Gauss' theorem:
\begin{align}
  \int_{\partial\Omega} \log\rho \, \mathrm{d}S
  &=
  - \frac{\Mach^2}{2}\int_{\Omega}
    \frac{\vec{\nabla}\vec{u}^2}{T} \, \mathrm{d}x
  \label{eq:logrho_nondim}
\\
  \int_{\partial\Omega} p \, \mathrm{d}S
  &=
  - \frac{\Mach^2}{2}\int_{\Omega} \rho \vec{\nabla}\vec{u}^2 \, \mathrm{d}x
  \label{eq:p_nondim}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Reduction to the radially symmetric, two-dimensional case}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Suppose a two-dimensional domain possessing radial symmetry so that
$\vec{u}={u}\!\left(r\right)\hat{r}$. Then~\eqref{eq:gibbsresult} is nothing
but the scalar equation
\begin{align}
  \frac{1}{r}u\!\left(r\right) + u^\prime\!\left(r\right)
  &= \frac{2 \Mach^2 u^2\!\left(r\right) u^\prime\!\left(r\right)}
          {\left(\gamma-1\right)\left(2H - \Mach^2 u^2\!\left(r\right)\right)}.
\end{align}
Suppressing the dependence of $u$ on $r$ and collecting $u^\prime$ terms,
\begin{align}
  u^\prime
  &=
  \frac{u}{r}
  \cdot
  \frac{\left(\gamma-1\right)2H - \left(\gamma-1\right)\Mach^2 u^2}
       {\left(\gamma+1\right)\Mach^2 u^2 - \left(\gamma-1\right)2H}
  \label{eq:cpfradial_nondim_ode}.
\end{align}
The univariate ordinary differential equation~\eqref{eq:cpfradial_nondim_ode}
permits integrating $u$ across $r\in\left[r_1, r_2\right]$ given a boundary
condition on either radius $r_1$ or $r_2$.  Temperature $T$ and sound speed $a$
remain pointwise-dependent on $u$ given $\gamma$, $\Mach$, and $H$. The
symmetry assumption reduces~\eqref{eq:logrho_nondim} to
\begin{align}
  \rho\!\left(r_2\right)
  &=
  \exp\left[
    - \frac{\Mach^2}{2} \int_{r_1}^{r_2}
        \frac{\left(u^2\right)'}{T}
      \, r \, \mathrm{d}r
    + \log\rho\!\left(r_1\right)
  \right]
   =
  \rho\!\left(r_1\right) \exp\left[
    - \Mach^2 \int_{r_1}^{r_2}
        \frac{u u'}{T}
      \, r \, \mathrm{d}r
  \right]
\label{eq:cpfradial_nondim_rho}
\end{align}
where the $2\pi$ factors arising from integrating cancel each other.
Likewise~\eqref{eq:p_nondim} simplifies to
\begin{align}
  p\!\left(r_2\right)
  &=
    - \frac{\Mach^2}{2} \int_{r_1}^{r_2}
        \rho \left(u'\right)^2
      \, r \, \mathrm{d}r
    + p\!\left(r_1\right)
   =
    -\Mach^2 \int_{r_1}^{r_2} \rho u u' \, r \, \mathrm{d}r
      + p\!\left(r_1\right)
\label{eq:cpfradial_nondim_p}.
\end{align}
Notice~\eqref{eq:cpfradial_nondim_ode} easily supplies $u'$ for the computation
of both $\rho$ and $p$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand*{\doi}[1]{\href{http://dx.doi.org/\detokenize{#1}}{doi: #1}}
\bibliographystyle{plainnat}
\bibliography{references}

\end{document}
