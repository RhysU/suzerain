
\todo{Edit the following for dimensional, reacting formulation}

\subsection{Isothermal, no slip boundary condition}

An isothermal wall is characterized by a fixed temperature and zero velocity.
One thermodynamic quantity must be allowed to vary for this boundary condition
to be well-posed.  Allowing $\rho$ to vary is simplest given our state choices.
Then~\eqref{eq:state_pressure} and~\eqref{eq:state_temperature} combined with
$m=0$ forces $e=\frac{T}{\gamma\left(\gamma-1\right)}$ for some fixed
temperature $T$.  These conditions may be built into linear operators for
implicit treatment using how B-spline basis support limits the number of
nonzero coefficients at the wall as discussed in
section~\ref{sec:formingoperators}.

\subsection{Nonreflecting freestream boundary conditions}
\label{sec:nonreflectingbcs}

When simulating problems on semi-infinite domains, such as flat plates,
Suzerain requires nonreflecting freestream boundary conditions.  Without these,
acoustic waves generated by the flow cannot be leave the domain.   The trapped
acoustics pile up causing a non-physical partition of energy and spoiling the
simulated statistics.

Following \citet{Engquist1977Absorbing},
\citet{Giles1988Nonreflecting,Giles1990Nonreflecting} developed localized,
approximate two-dimensional, unsteady nonreflecting boundary conditions for the
Euler equations.  Giles' boundary conditions are adopted over the ``locally
one-dimensional inviscid'' relations of \citet{Poinsot1992Boundary} because
other codes with similar numerics have successfully employed Giles' conditions
for our problems of interest.  While \citet{Rowley2000Discretely} present
higher order techniques expected to perform better than Giles' approach, what
they describe is considerably more complex to implement.
\citet{Saxer1993QuasiThreeDimensional} extended the technique to three
dimensions but with a presentation aimed towards transonic axial flow
turbomachinery computations.  \citet{Guarini1998} summarizes the Cartesian
extension of Giles' approach to three spatial dimensions without reproducing
the associated analysis.  \citet{Medida2007} lucidly catalogs the intermediate
results necessary in three dimensions.

We now review Giles' approach following Guarini's presentation with the goal of
setting notation suitable for presenting and manipulating Medida's results for
nonreflecting $x$ boundaries in three-dimensional, Cartesian coordinates.  For
complete details, especially motivations and proofs, the work of Giles, Medida,
and Guarini should be consulted in that respective order.

For the state vector
\begin{subequations}
\label{eq:eulerprim}
\begin{align}
  U &= \left\{ \rho, u, v, w, p \right\}
\end{align}
the Euler equations, using the ideal gas equation of state
\begin{align}
  \rho a^2 &= \gamma p,
\end{align}
may be written as follows:
\begin{align}
    \frac{\partial}{\partial{}t}U
+ A \frac{\partial}{\partial{}x}U
+ B \frac{\partial}{\partial{}y}U
+ C \frac{\partial}{\partial{}z}U
&= 0
\end{align}
\begin{align}
 A &= \begin{bmatrix}
        u & \rho     & 0 & 0 & 0              \\
        0 & u        & 0 & 0 & \frac{1}{\rho} \\
        0 & 0        & u & 0 & 0              \\
        0 & 0        & 0 & u & 0              \\
        0 & \gamma p & 0 & 0 & u              \\
       \end{bmatrix}
&
 B &= \begin{bmatrix}
        v & 0 & \rho     & 0 & 0              \\
        0 & v & 0        & 0 & 0              \\
        0 & 0 & v        & 0 & \frac{1}{\rho} \\
        0 & 0 & 0        & v & 0              \\
        0 & 0 & \gamma p & 0 & v              \\
       \end{bmatrix}
&
 C &= \begin{bmatrix}
        w & 0 & 0 & \rho     & 0              \\
        0 & w & 0 & 0        & 0              \\
        0 & 0 & w & 0        & 0              \\
        0 & 0 & 0 & w        & \frac{1}{\rho} \\
        0 & 0 & 0 & \gamma p & w              \\
       \end{bmatrix}
\end{align}
\end{subequations}
This system of equations identically describes the behavior of an analogous
$U^*$ whenever all of
\begin{align}
\label{eq:eulerprimnondim}
U^{*} &= \left\{
  \frac{\rho}{\rho_0},
  \frac{u}{u_0},
  \frac{v}{u_0},
  \frac{w}{u_0},
  \frac{p}{\rho_0 u_0^2}
\right\}
&
t_0 &= \frac{l_0}{u_0}
&
a_0 &= u_0
\end{align}
hold.  Therefore, all dimensional results obtained for $U$ remain unchanged
in the setting of $U^*$.

Consider perturbations
\[
\delta{}U = \left\{ \delta{}\rho, \delta{}u,
\delta{}v, \delta{}w, \delta{}p \right\}
\]
taken about some steady,
uniform reference state $\bar{U}$ so that
\[
U = \bar{U} + \delta{}U.
\]
The short-time evolution of such perturbations is governed by the linearized
Euler equations
\begin{align}
\label{eq:dimeulerperturb}
               \frac{\partial}{\partial{}t}\delta{}U
+ \bar{A} \frac{\partial}{\partial{}x}\delta{}U
+ \bar{B} \frac{\partial}{\partial{}y}\delta{}U
+ \bar{C} \frac{\partial}{\partial{}z}\delta{}U
&= 0
\end{align}
where matrices $\bar{A}$, $\bar{B}$, and $\bar{C}$ are evaluated
at $\bar{U}$.  This linearized system satisfies the prerequisites for
Giles' analysis.  Assuming a solution of the form
\begin{align}
  \delta{}U &= e^{\ii\left(
    k_x x + k_y y + k_z z - \omega t
  \right)}
  \delta\hat{U}^R
\end{align}
and substituting into the linearized equations reduces the equations to
\begin{align}
\label{eq:dimeulerreduced}
  \ii\left( - \omega I
            + k_x \bar{A}
            + k_y \bar{B}
            + k_z \bar{C}
  \right)
  \delta\hat{U}^R &= 0
\end{align}
which has nontrivial solutions only if the so-called dispersion relation
\begin{align}
  \det \left( - \omega I
              + k_x \bar{A}
              + k_y \bar{B}
              + k_z \bar{C}
       \right) &= 0
\end{align}
holds.  Defining $\lambda_x = k_x/\omega$, $\lambda_y = k_y/\omega$, and
$\lambda_z/\omega$, the dispersion relation may be equivalently expressed as
\begin{align}
\label{eq:dimeulerdisp}
  \det \left( - I
              + \lambda_x \bar{A}
              + \lambda_y \bar{B}
              + \lambda_z \bar{C}
       \right) &= 0
  .
\end{align}
Assuming $\bar{A}$ is invertible and applying
$-\left(\ii\omega{}\bar{A}\right)^{-1}$ to
equation~\eqref{eq:dimeulerreduced}, one finds an eigenvalue problem in
$\lambda_x$
\begin{align}
  \left(   \bar{A}^{-1}
         - \lambda_x I
         - \lambda_y \bar{A}^{-1} \bar{B}
         - \lambda_z \bar{A}^{-1} \bar{C}
  \right) \delta\hat{U}^R = 0
\end{align}
where $\delta\hat{U}^R$ is the eigenvector and a solution to the right null
space problem.  The signs of the associated eigenvalues, determined using the
magnitude of $\bar{u}$ relative to $\bar{a}$, are required to determine how
many characteristics are entering or exiting through the boundary.  The left
null space problem
\begin{align}
\label{eq:dimeulereigenprob}
  V^{L}
  \left(   \bar{A}^{-1}
         - \lambda_x I
         - \lambda_y \bar{A}^{-1} \bar{B}
         - \lambda_z \bar{A}^{-1} \bar{C}
  \right) &= 0
\end{align}
naturally gives rise to the associated left null vector $V^L$.  Giles,
following Engquist and Majda, used several orthogonality properties to build
the exact, nonreflecting boundary conditions
\begin{align}
\label{eq:dimeulerexact}
  V_n^L \delta{}U &= 0
\end{align}
for each $V_n^L = V^L\!\left(k_{x_n}\right)$ corresponding to \textit{either
incoming or outgoing waves}.  This exact condition is approximated using a
Taylor series in $\lambda_y$ and $\lambda_z$ for reasons of computational
tractability.  Truncating the series is equivalent to assuming waves have a
small angle of incidence to the boundary.  To first order,
\begin{align}
  \left.V_n^L\right|_{\lambda_y,\lambda_z=0}
  \delta{}U
  +
  \lambda_y
  \left.\frac{dV_n^L}{d\lambda_y}\right|_{\lambda_y,\lambda_z=0}
  \delta{}U
  +
  \lambda_z
  \left.\frac{dV_n^L}{d\lambda_z}\right|_{\lambda_y,\lambda_z=0}
  \delta{}U
  &\approx 0
  .
\end{align}
As noted by \citet{Engquist1977Absorbing} and later expounded upon by
\citet{Trefethen1986Wellposedness}, only particular higher-order series
truncations of this form lead to well-posedness.  Moreover, the straightforward
application of even this first order approximation requires either
ad~hoc~\citep{Giles1988Nonreflecting,Medida2007} or
systematic~\citep{Rowley2000Discretely} modification to produce well-behaved
inflow constraints.  Multiplying through by $-\ii\omega$, Fourier transforming
in both time and space, and using that $\bar{U}$ and therefore $V_n^L$ are both
steady and uniform yields
\begin{align}
\label{eq:dimeulerapprox}
  \frac{\partial}{\partial{}t}
  V^L
  \delta{}U
  &\approx
  \frac{dV^L}{d\lambda_y}
  \frac{\partial}{\partial{}y}\delta{}U
  +
  \frac{dV^L}{d\lambda_z}
  \frac{\partial}{\partial{}z}\delta{}U
\end{align}
where the cumbersome $\lambda_y,\lambda_z=0$ and subscript $n$ are herein
and henceforth suppressed.  Inserting ${V^L}^{-1} V^L$,
\begin{align}
  \frac{\partial}{\partial{}t}
  V^L
  \delta{}U
  &\approx
  \frac{dV^L}{d\lambda_y}
  {V^L}^{-1}
  \frac{\partial}{\partial{}y}
  V^L
  \delta{}U
  +
  \frac{dV^L}{d\lambda_z}
  {V^L}^{-1}
  \frac{\partial}{\partial{}z}
  V^L
  \delta{}U
.
\end{align}
Defining characteristic variables using the action of $V^L$, \textit{viz.}
\begin{align}
  \delta{}C &= V^L \delta{}U
  ,
\end{align}
allows writing a more compact form
\begin{align}
\label{eq:dimeulerapproxchar}
  \frac{\partial}{\partial{}t}
  \delta{}C
  &\approx
  B^G
  \frac{\partial}{\partial{}y}
  \delta{}C
  +
  C^G
  \frac{\partial}{\partial{}z}
  \delta{}C
\end{align}
employing the notation
\begin{align}
\label{eq:dimeulerapproxBG}
  B^G
&=
  \frac{dV^L}{d\lambda_y}
  {V^L}^{-1}
&
  C^G
&=
  \frac{dV^L}{d\lambda_z}
  {V^L}^{-1}
\end{align}
where the superscript $G$ is meant to suggest ``Giles''.  This last statement
intermixes the constraints for inflow and outflow conditions.  While the
submatrices vary depending on the choices made to express $V^L$ and the
magnitude of $\bar{u}$ relative to $\bar{a}$, in complete generality the matrix
equation~\eqref{eq:dimeulerapproxchar} may be partitioned as
\begin{align}
\label{eq:dimeulerapproxcharpart}
\renewcommand*{\arraystretch}{1.2}
  \frac{\partial}{\partial{}t}
  \left[\begin{array}{c}\delta{}C_{I}\\\hline\delta{}C_{O}\end{array}\right]
  &\approx
\renewcommand*{\arraystretch}{1.2}
  \left[\begin{array}{c} B^G_{I} \\ \hline B^G_{O} \end{array}\right]
  \frac{\partial}{\partial{}y}
  \delta{}C
  +
  \left[\begin{array}{c} C^G_{I} \\ \hline C^G_{O} \end{array}\right]
  \frac{\partial}{\partial{}z}
  \delta{}C
\end{align}
where subscripts $I$ and $O$ denote inflow or outflow condition submatrices,
respectively.  Only the conditions arising from one set of submatrices are to
be applied at any location.  The ``other'' submatrices are defined to be zero
depending on the use case at hand:
\begin{align}
  B^G &=
\renewcommand*{\arraystretch}{1.2}
  \left[\begin{array}{c} B^G_{I} \\ \hline 0       \end{array}\right]
  &
  C^G &=
\renewcommand*{\arraystretch}{1.2}
  \left[\begin{array}{c} C^G_{I} \\ \hline 0       \end{array}\right]
  &
  &\left(\text{inflow boundary}\right)
\\
  B^G &=
\renewcommand*{\arraystretch}{1.2}
  \left[\begin{array}{c} 0       \\ \hline B^G_{O} \end{array}\right]
  &
  C^G &=
\renewcommand*{\arraystretch}{1.2}
  \left[\begin{array}{c} 0       \\ \hline C^G_{O} \end{array}\right]
  &
  &\left(\text{outflow boundary}\right)
\end{align}
Notationally, it will later be convenient to have a projection
\begin{align}
\label{eq:PG}
\renewcommand*{\arraystretch}{1.2}
  P^G
  &=
  \left[\begin{array}{c} P^G_{I} \\ \hline P^G_{O} \end{array}\right]
\end{align}
defined to preserve only the characteristic(s) constrained by a boundary
condition with the ``other'' submatrix again being zero.  This definition
implies
\begin{align}
\label{eq:PGidempotence}
  P^G B^G &= B^G
  &
  P^G C^G &= C^G
.
\end{align}
Notice $I - P^G$ recovers the characteristics \emph{not} constrained by the
boundary condition For some $\bar{U}$ possessing an agreed upon relationship
between $\bar{u}$ and $\bar{a}$, specifying $V^L$ and these partitioned
submatrices concretely states a Giles-like nonreflecting $x$ boundary condition
for the Euler equations.

In section 5.8 of his thesis, Medida presents two such concrete nonreflecting
boundary condition specifications for subsonic inflows and outflows where $0 <
\bar{u} < \bar{a}$.  Medida's equations~(5.78) and~(5.79) specify the
transformations to and from characteristic variables:
\begin{align}
\label{eq:dimeulerapproxmedidaproj}
  V^L &= \left[\begin{array}{ccccc}
    -\bar{a}^2 & 0                   & 0                  & 0                  & 1 \\ \noalign{\smallskip}
    0          & 0                   & \bar{\rho} \bar{a} & 0                  & 0 \\ \noalign{\smallskip}
    0          & 0                   & 0                  & \bar{\rho} \bar{a} & 0 \\ \noalign{\smallskip}
    0          & \bar{\rho} \bar{a}  & 0                  & 0                  & 1 \\ \noalign{\smallskip}
    0          & -\bar{\rho} \bar{a} & 0                  & 0                  & 1 \\ \noalign{\smallskip}
  \end{array}\right]
&
  {V^L}^{-1} &= \left[\begin{array}{ccccc}
    -\frac{1}{\bar{a}^2} & 0                            & 0                            & \frac{1}{2\bar{a}^2}          & \frac{1}{2\bar{a}^2}            \\ \noalign{\smallskip}
    0                    & 0                            & 0                            & \frac{1}{2\bar{\rho} \bar{a}} & - \frac{1}{2\bar{\rho} \bar{a}} \\ \noalign{\smallskip}
    0                    & \frac{1}{\bar{\rho} \bar{a}} & 0                            & 0                             & 0                               \\ \noalign{\smallskip}
    0                    & 0                            & \frac{1}{\bar{\rho} \bar{a}} & 0                             & 0                               \\ \noalign{\smallskip}
    0                    & 0                            & 0                            & \frac{1}{2}                   & \frac{1}{2}                     \\ \noalign{\smallskip}
  \end{array}\right]
\end{align}
Direct computation shows
\[
  \det V^L = -2\bar{\rho}^3\bar{a}^5
\]
and so $V^L$ is always nonsingular for a realizable reference state.  Medida's
equations~(5.82) and~(5.83) provide one pair of inflow and outflow conditions
for which reflection coefficients were not reported:
\begin{align}
\label{eq:dimeulerapproxmedidaopt1}
  B^G_1 &= \left[\begin{array}{ccccc}
    0 & 0                         & 0       & 0                           & 0                         \\ \noalign{\smallskip}
    0 & \bar{v}                   & 0       & \frac{\bar{a} + \bar{u}}{2} & \frac{\bar{a}-\bar{u}}{2} \\ \noalign{\smallskip}
    0 & 0                         & \bar{v} & 0                           & 0                         \\ \noalign{\smallskip}
    0 & \frac{\bar{a}-\bar{u}}{2} & 0       & \bar{v}                     & 0                         \\ \noalign{\smallskip} \hline
    0 & \bar{u}                   & 0       & 0                           & \bar{v}                   \\ \noalign{\smallskip}
  \end{array}\right]
&
  C^G_1 &= \left[\begin{array}{ccccc}
    0 & 0       & 0                         & 0                         & 0                         \\ \noalign{\smallskip}
    0 & \bar{w} & 0                         & 0                         & 0                         \\ \noalign{\smallskip}
    0 & 0       & \bar{w}                   & \frac{\bar{a}+\bar{u}}{2} & \frac{\bar{a}-\bar{u}}{2} \\ \noalign{\smallskip}
    0 & 0       & \frac{\bar{a}-\bar{u}}{2} & \bar{w}                   & 0                         \\ \noalign{\smallskip} \hline
    0 & 0       & \bar{u}                   & 0                         & \bar{w}                   \\ \noalign{\smallskip}
  \end{array}\right]
\end{align}
where partitioning has been used to delineate inflow versus outflow submatrices
within $B^G$ and $C^G$.  The characteristic-preserving projection operator is
\begin{align}
\label{eq:PGmedida}
  P^G
  &= \left[\begin{array}{ccccc}
    1 & 0 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 & 0 \\
    0 & 0 & 1 & 0 & 0 \\
    0 & 0 & 0 & 1 & 0 \\ \hline
    0 & 0 & 0 & 0 & 1 \\
  \end{array}\right]
.
\end{align}
We assume, but have not verified, analysis like that presented in
\citet[\textsection{}3.7.4]{Giles1988Nonreflecting} extends to Medida's
analogous results.  At the inflow, the outgoing pressure wave produces no
reflected entropy or vorticity waves and generates a fourth-order pressure
reflection.  At the outflow, the outgoing entropy and vorticity waves produce
no reflections while the outgoing pressure wave produces a second order
reflection.  In contrast, Medida's equation~(5.84), which arises from modifying
the already-well-posed outflow condition to match the well-posed inflow
condition, provides different outflow submatrices:
\begin{align}
\label{eq:dimeulerapproxmedidaopt2}
  B^G_2 &= \left[\begin{array}{ccccc}
    0 & 0                         & 0       & 0                           & 0                         \\ \noalign{\smallskip}
    0 & \bar{v}                   & 0       & \frac{\bar{a} + \bar{u}}{2} & \frac{\bar{a}-\bar{u}}{2} \\ \noalign{\smallskip}
    0 & 0                         & \bar{v} & 0                           & 0                         \\ \noalign{\smallskip}
    0 & \frac{\bar{a}-\bar{u}}{2} & 0       & \bar{v}                     & 0                         \\ \noalign{\smallskip} \hline \noalign{\smallskip}
    0 & \frac{\bar{a}+\bar{u}}{2} & 0       & 0                           & \bar{v}                   \\ \noalign{\smallskip}
  \end{array}\right]
&
  C^G_2 &= \left[\begin{array}{ccccc}
    0 & 0       & 0                         & 0                         & 0                         \\ \noalign{\smallskip}
    0 & \bar{w} & 0                         & 0                         & 0                         \\ \noalign{\smallskip}
    0 & 0       & \bar{w}                   & \frac{\bar{a}+\bar{u}}{2} & \frac{\bar{a}-\bar{u}}{2} \\ \noalign{\smallskip}
    0 & 0       & \frac{\bar{a}-\bar{u}}{2} & \bar{w}                   & 0                         \\ \noalign{\smallskip} \hline \noalign{\smallskip}
    0 & 0       & \frac{\bar{a}+\bar{u}}{2} & 0                         & \bar{w}                   \\ \noalign{\smallskip}
  \end{array}\right]
\end{align}
At the outflow, these matrices cause outgoing pressure waves to produce fourth
and first order reflections, respectively.  As Giles
notes~\citep{Giles1990Nonreflecting}, this second outflow condition is
preferable only when one knows there will be no outgoing vorticity wave.  This
should be the case for some of our problems of interest.

In section~4.3 of his thesis, \citet{Guarini1998} proved the linear
structure of the Euler equations admits a straightforward translation of Giles'
boundary conditions to another set of state variables $V$ with steady, uniform
reference state $\bar{V}$ and therefore perturbations
\[
  \delta{}V = V - \bar{V}.
\]
The corresponding coordinate transformation Jacobian matrix is
\[
   S = \frac{\partial{}U}{\partial{}V}
   .
\]
In this new setting, Guarini rewrote the exact nonreflecting
conditions~\eqref{eq:dimeulerexact} as
\begin{align}
  \left(V^L S\right) \delta{}V &= 0
\end{align}
which causes the approximate condition~\eqref{eq:dimeulerapprox} to become
\begin{align}
\label{eq:dimeulertransform}
  V^L
  S
  \frac{\partial}{\partial{}t}
  \delta{}V
  &\approx
  \frac{dV^L}{d\lambda_y}
  S
  \frac{\partial}{\partial{}y}
  \delta{}V
  +
  \frac{dV^L}{d\lambda_z}
  S
  \frac{\partial}{\partial{}z}
  \delta{}V
  .
\end{align}
Using notation from the compact representation~\eqref{eq:dimeulerapproxBG},
\begin{align}
\label{eq:dimeulertransformcharnot}
  V^L S
  \frac{\partial}{\partial{}t}
  \delta{}V
  &\approx
  B^G V^L S
  \frac{\partial}{\partial{}y}
  \delta{}V
  +
  C^G V^L S
  \frac{\partial}{\partial{}z}
  \delta{}V
\end{align}
is the simplest form for applying Medida's $x$ boundary condition matrices to
alternative state variables.

The particular coordinate transformation Suzerain requires maps the
nondimensional primitive state $U^*$ satisfying
requirements~\eqref{eq:eulerprimnondim} to the conserved state $V^*$
nondimensionalized per sections~\ref{sec:nondimrefq}
and~\ref{nondim_equations}:
\begin{align}
\label{eq:eulerconsnondim}
V^{*}
&= \left\{
  \frac{\rho}{\rho_0},
  \frac{\rho u}{\rho_0 u_0},
  \frac{\rho v}{\rho_0 u_0},
  \frac{\rho w}{\rho_0 u_0},
  \frac{\rho E}{\rho_0 a_0^2}
\right\}
= \left\{
    \rho^{*},
  \,\rho^{*} u^{*},
  \,\rho^{*} v^{*},
  \,\rho^{*} w^{*},
  \,\rho^{*} E^{*}
\right\}
&
a^{*} &= \frac{a}{a_0}
&
\Mach &= \frac{u_0}{a_0}
&
t_0 &= \frac{l_0}{u_0}
\end{align}
Observing several relationships between $U^*$ and $V^*$ with care to
distinguish between $u_0$ and $a_0$
\begin{align}
  \frac{\rho}{\rho_0} &= \rho^*
&
  \frac{u}{u_0} &=
  \frac{\frac{\rho{}u}{\rho_0u_0}}{\frac{\rho}{\rho_0}}
  =
  \frac{\rho^{*}u^{*}}{\rho^{*}}
&
  \frac{v}{u_0} &= \frac{\rho^{*}v^*}{\rho^*}
&
  \frac{w}{u_0} &= \frac{\rho^{*}w^*}{\rho^*}
&
 \frac{p}{\rho_0 u_0^2} &= \frac{\rho a^2}{\gamma \rho_0 u_0^2}
                         = \frac{\rho^{*} {a^{*}}^2}{\gamma\Mach^2}
\end{align}
\begin{align}
 \frac{p}{\rho_0 u_0^2}
&=
   \frac{\gamma-1}{\rho_0 u_0^2} \rho E
 + \frac{1-\gamma}{2 \rho_0 u_0^2 \rho}\left(
           \left(\rho{}u\right)^2
         + \left(\rho{}v\right)^2
         + \left(\rho{}w\right)^2
   \right)
=
   \frac{\gamma-1}{\Mach^2} \rho^{*} E^{*}
 + \frac{1-\gamma}{2 \rho^{*}}\left(
           \left(\rho^{*}u^{*}\right)^2
         + \left(\rho^{*}v^{*}\right)^2
         + \left(\rho^{*}w^{*}\right)^2
   \right)
\end{align}
aids computing the Jacobian matrix evaluated at some $\bar{V}^{*}$,
\begin{align}
S &= \left[\begin{array}{ccccc}
    1      % 11
  & 0      % 12
  & 0      % 13
  & 0      % 14
  & 0      % 15
  \\ \noalign{\medskip}
    - \frac{\bar{u}^*}{\bar{\rho}^*} % 21
  & \frac{1}{\bar{\rho}^*}           % 22
  & 0                                % 23
  & 0                                % 24
  & 0                                % 25
  \\ \noalign{\medskip}
    - \frac{\bar{v}^*}{\bar{\rho}^*} % 31
  & 0                                % 32
  & \frac{1}{\bar{\rho}^*}           % 33
  & 0                                % 34
  & 0                                % 35
  \\ \noalign{\medskip}
    - \frac{\bar{w}^*}{\bar{\rho}^*} % 41
  & 0                                % 42
  & 0                                % 43
  & \frac{1}{\bar{\rho}^*}           % 44
  & 0                                % 45
  \\ \noalign{\medskip}
    \frac{{\bar{a}^*}^2}{\gamma\Mach^2} % 51
  & \left(1 - \gamma\right) \bar{u}^*   % 52
  & \left(1 - \gamma\right) \bar{v}^*   % 53
  & \left(1 - \gamma\right) \bar{w}^*   % 54
  & \frac{\gamma-1}{\Mach^2}            % 55
  \\ \noalign{\medskip}
\end{array}\right]
.
\end{align}
%Examining $\rho = \rho{}u/u$ closely confirms the slightly
%unintuitive zeros in the first row of $S$ because
%\[
%    \frac{\partial}{\partial\rho{}u} \rho
%  = \frac{\partial}{\partial\rho{}u} \frac{\rho{}u}{u\!\left(\rho,\rho{}u\right)}
%  = \frac{1}{u\!\left(\rho,\rho{}u\right)}
%  - \frac{\rho{}u}{u^2\!\left(\rho,\rho{}u\right)}
%    \frac{\partial}{\partial\rho{}u}u\!\left(\rho,\rho{}u\right)
%  = \frac{1}{u}
%  - \frac{\rho{}u}{u^2}\frac{1}{\rho}
%  = 0
%.
%\]
As expected, the transformation is nonsingular for realizable fields because
\[
  \det S = \frac{\gamma-1}{\Mach^2 {\bar{\rho}^{*}}^3}.
\]
The inverse is
\begin{align}
S^{-1} &= \left[\begin{array}{ccccc}
  1                                                                                          & 0                              & 0                              & 0                              & 0                        \\
  \bar{u}^{*}                                                                                & \bar{\rho}^*                   & 0                              & 0                              & 0                        \\
  \bar{v}^{*}                                                                                & 0                              & \bar{\rho}^*                   & 0                              & 0                        \\
  \bar{w}^{*}                                                                                & 0                              & 0                              & \bar{\rho}^*                   & 0                        \\
  \Mach^2\left(\bar{u}^2+\bar{v}^2+\bar{w}^2\right)+\frac{{\bar{a}^{*}}^2}{\gamma(1-\gamma)} & \Mach^2 \bar{\rho}^* \bar{u}^* & \Mach^2 \bar{\rho}^* \bar{v}^* & \Mach^2 \bar{\rho}^* \bar{w}^* & \frac{\Mach^2}{\gamma-1}
\end{array}\right]
.
\end{align}
Medida's matrices $V^L$, $B^G$, and $C^G$ derived for $U$ remain valid for
nondimensional $U^*$ possessing sound speed $a/u_0$.  When reusing these
matrices for $V^*$ every sound speed must be scaled by $1/\Mach$ because
\[
  \frac{\bar{a}}{u_0} = \frac{a_0 \bar{a}^*}{u_0} = \frac{\bar{a}^*}{\Mach}.
\]

Thus far nonreflecting $x$ boundary conditions in physical space have been
presented.  Suzerain requires rotating these results to handle nonreflecting
$y$ boundaries followed by transforming the constraints into coefficient space.
Defining
\begin{align}
  x' &= z &
  y' &= x &
  z' &= y
\intertext{
induces the following relationships:
}
  u &= v' &
  v &= w' &
  w &= u'
\\
  \frac{\partial}{\partial{}x} &= \frac{\partial}{\partial{}y'} &
  \frac{\partial}{\partial{}y} &= \frac{\partial}{\partial{}z'} &
  \frac{\partial}{\partial{}z} &= \frac{\partial}{\partial{}x'}
\end{align}
The perturbed state vector entries may be reordered more conventionally by
defining $R^Y$ and $\delta{}V'$ per
\begin{align}
  \delta{}V
  &= \begin{bmatrix}
       \delta\rho     \\
       \delta\rho{}v' \\
       \delta\rho{}w' \\
       \delta\rho{}u' \\
       \delta\rho{}E  \\
     \end{bmatrix}
  = R^Y \delta{}V'
  = \begin{bmatrix}
      1 & 0 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 & 0 \\
      0 & 0 & 0 & 1 & 0 \\
      0 & 1 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
      \delta\rho     \\
      \delta\rho{}u' \\
      \delta\rho{}v' \\
      \delta\rho{}w' \\
      \delta\rho{}E  \\
    \end{bmatrix}
  .
\end{align}
Substituting these details into equation~\eqref{eq:dimeulertransformcharnot}
produces the desired nonreflecting $y$ boundary condition,
\[
\label{eq:dimeulertransformcharnotYwieldy}
\left.\left[
  V^L S
\right]\right|_{\bar{u}=\bar{v}', \bar{v}=\bar{w}', \bar{w}=\bar{u}'}
  R^Y
  \frac{\partial}{\partial{}t}
  \delta{}V'
\approx
\left.\left[
  C^G V^L S
\right]\right|_{\bar{u}=\bar{v}', \bar{v}=\bar{w}', \bar{w}=\bar{u}'}
  R^Y
  \frac{\partial}{\partial{}x'}
  \delta{}V'
  +
\left.\left[
  B^G V^L S
\right]\right|_{\bar{u}=\bar{v}', \bar{v}=\bar{w}', \bar{w}=\bar{u}'}
  R^Y
  \frac{\partial}{\partial{}z'}
  \delta{}V'
.
\]
Suppressing the primes and matrix evaluation details makes the above result
much more wieldy,
\[
\label{eq:dimeulertransformcharnotYphys}
  \left[V^L S\right]
  R^Y
  \frac{\partial}{\partial{}t}
  \delta{}V
\approx
  \left[C^G V^L S\right]
  R^Y
  \frac{\partial}{\partial{}x}
  \delta{}V
  +
  \left[B^G V^L S\right]
  R^Y
  \frac{\partial}{\partial{}z}
  \delta{}V
.
\]
Transforming to Fourier space gives a linear condition almost suitable for
implicit advance per section~\ref{sec:timediscretization},
\begin{align}
\label{eq:dimeulertransformcharnotYwave}
  \left[V^L S\right]
  R^Y
  \frac{\partial}{\partial{}t}
  \hat{V}
&\approx
  \ii k_x
  \left[C^G V^L S\right]
  R^Y
  \hat{V}
  +
  \ii k_z
  \left[B^G V^L S\right]
  R^Y
  \hat{V}
.
\end{align}
This last result holds identically for boundary collocation points and boundary
coefficients because the boundary value for a B-spline basis expansion is
nothing but the boundary coefficient.  Notice that when $k_x=k_z=0$ the
relevant characteristics within the mean state are held constant in time.

While constraint~\eqref{eq:dimeulertransformcharnotYwave} fixes the
characteristics arriving from beyond the boundary, it does not evolve the
remaining ones determined by the simulation domain.  Returning to the time
discretization of section~\ref{sec:timediscretization},
equation~\eqref{eq:timediscretization} evolves coefficients more or less like
\begin{align}
\label{eq:coeffspaceevolve}
  \frac{\partial}{\partial{}t} \hat{V} &= L \hat{V} + N(\hat{V})
  .
\end{align}
At the nonreflecting $y$ boundary, projecting the evolution into characteristic
space yields
\begin{align}
  \left[V^L S\right] R^Y
  \frac{\partial}{\partial{}t} \hat{V} &=
  \left[V^L S\right] R^Y
  \left(
    L \hat{V}
    +
    N(\hat{V})
  \right)
  .
\end{align}
Updating only the unconstrained characteristics using $P^G$ as defined
\vpageref{eq:PG},
\begin{align}
  \left(I - P^G\right)
  \left[V^L S\right] R^Y
  \frac{\partial}{\partial{}t} \hat{V}
&=
  \left(I - P^G\right)
  \left[V^L S\right] R^Y
  \left(
    L \hat{V}
    +
    N(\hat{V})
  \right)
  .
\end{align}
Applying $P^G$ to both sides of
equation~\eqref{eq:dimeulertransformcharnotYwave}, simplifying
using~\eqref{eq:PGidempotence}, and adding that to the above equality,
\begin{align}
  \left[V^L S\right]
  R^Y
  \frac{\partial}{\partial{}t}
  \hat{V}
&\approx
  \ii k_x
  \left[C^G V^L S\right]
  R^Y
  \hat{V}
  +
  \ii k_z
  \left[B^G V^L S\right]
  R^Y
  \hat{V}
\\
&{}+
  \left(I - P^G\right)
  \left[V^L S\right] R^Y
  \left(
    L \hat{V}
    +
    N(\hat{V})
  \right)
.
\end{align}
Moving the nonsingular characteristic projection to the right hand side and
collecting linear terms,
\begin{align}
\label{eq:dimeulertransformevolve}
  \frac{\partial}{\partial{}t}
  \hat{V}
&\approx
\overbrace{
  {R^Y}^{-1}
  \left[V^L S\right]^{-1}
  \left(
    \left( \ii k_x \left[C^G\right] + \ii k_z \left[B^G\right] \right)
    \left[V^L S\right] R^Y
    +
    \left(I-P^G\right)
    \left[V^L S\right] R^Y
    L
  \right)
}^{L^G}
  \hat{V}
\\
&{}+
\underbrace{
  {R^Y}^{-1}
  \left[V^L S\right]^{-1}
  \left(I - P^G\right)
  \left[V^L S\right] R^Y
  N(\hat{V})
}_{N^G\left(\hat{V}\right)}
,
\end{align}
a boundary evolution equation matching the form~\eqref{eq:coeffspaceevolve} is
recovered.  Further auxiliary definitions could improve the previous equation's
brevity but they would obfuscate the derivation and the physics.

While the derivation of this section's results has assumed a steady $\bar{V}$,
in practice $\bar{V}$ is not constant.  For example, the spatially-averaged,
instantaneous wall-normal outflow velocity generated by a homogenized boundary
layer problem may be unknown and will vary in time.  The mean state at the
beginning of the first Runge--Kutta substep should be taken as the ``steady''
$\bar{V}$ for the direction of the time step.  The mean state should be evolved
according to equation~\eqref{eq:dimeulertransformevolve} modified to account
for any auxiliary constraints (e.g. holding freestream streamwise momentum
constant at each substep).

Evidently, Giles' conditions can be shoehorned into
section~\ref{sec:imextreatment}'s IMEX Runge--Kutta framework by modifying the
action of any existing global operators $L$ and $N$ to obtain the
boundary-specific $L^G$ and $N^G$ behavior specified by
equation~\eqref{eq:dimeulertransformevolve}.  Implementing
$\left(M+\varphi{}L^G\right)\hat{V}$ in an $L$-agnostic way atop an existing
routine accumulating $\left(M+\varphi{}L\right)\hat{V}$ out-of-place is best
done by having the latter routine return $\varphi{}L\hat{V}$ so that the
incremental action of $L^G$ relative to $L$ can be further accumulated:
\begin{alignat}{10}
% Makes no sense to me that I needed to use phantom below...
% ...instead of being able to just use alignat directly.
\left(M+\varphi{}L^G\right)\hat{V} - \left(M+\varphi{}L\right)\hat{V}
  &={}   &&\ii \varphi{} k_x \, &&{R^Y}^{-1} \left[V^L S\right]^{-1} &&\left[C^G\right]                    &&\left[V^L S\right] {R^Y} &&\,\,\hat{V} \\
  &{}+{} &&\ii \varphi{} k_z    &&{R^Y}^{-1} \left[V^L S\right]^{-1} &&\left[B^G\right]                    &&\left[V^L S\right] {R^Y} &&\,\,\hat{V} \\
  &{}-{} &&                     &&{R^Y}^{-1} \left[V^L S\right]^{-1} &&\phantom{\Bigl[}P^G\phantom{\Bigr]} &&\left[V^L S\right] {R^Y} &&\left(\varphi{}L\hat{V}\right)
\end{alignat}
The auxiliary work and storage required is small and scales like two times the
number of equations as $\varphi{}L\hat{V}$ need only be returned for at most
the two boundaries of $\hat{V}$.  No special handling is required for in-place
application as it is currently implemented by incrementally applying
out-of-place routines using auxiliary buffers.  Implementing
$\left(M+\varphi{}L^G\right)^{-1}$ atop $\left(M+\varphi{}L\right)^{-1}$ is
best done by modifying the boundary equations after $M+\varphi{}L$ is formed
but before the matrix is factorized.  Doing so requires using that, for a
B-spline basis, $M$ contains only a single one in the boundary equations with
all other entries being zero.  Happily, $N^G(\hat{V})$ can be found by a
straightforward linear transformation of $N(\hat{V})$ after the latter has been
computed.  The required $C^G$-, $B^G$-, and $P^G$-related matrices may be
computed only once per nonreflecting boundary per Runge--Kutta time step from
$\bar{V}$ and then cached for repeated use.

Finally, \citet{Guarini1998} mentions that \citet{Poinsot1992Boundary}
suggest two additional viscous conditions be supplied when conditions like
these are applied to the Navier--Stokes equations.  These are currently omitted
but that choice may need to be revisited.  Guarini also rotated the
nonreflecting boundary to match the nonorthogonal coordinate system used for
his spatially-homogenized boundary layer.  Personal communications with Victor
Topalian regarding his temporally-homogenized work suggests reorienting the
nonreflecting coordinate system is unnecessary.  However, modest grid
stretching near the freestream and other ``solution conditioning'' tools like
low pass filtering have been employed in his work.  This choice, too, might
need to be reviewed.

\subsection{Isothermal, transpiring wall boundary condition}

TODO  Reuse nonreflecting freestream conditions with pegged inflow momentum and
total energy?  Possibly dropping the derivative terms to get a ``noisier''
wall that reflects acoustics but permits purely plane waves to pass into
the wall?
