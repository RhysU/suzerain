\documentclass[letterpaper,11pt,nointlimits,reqno]{amsart}

% Packages
\usepackage{accents}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{cancel}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage{fullpage}
\usepackage{ifthen}
\usepackage{lastpage}
\usepackage{latexsym}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{pstricks}
\usepackage{setspace}
\usepackage{txfonts}
\usepackage{units}
\usepackage{varioref}
\usepackage{wrapfig}

\mathtoolsset{showonlyrefs,showmanualtags}
\allowdisplaybreaks[1] % Allow grouped equations to be split across pages

% Line Spacing
\singlespacing

% Set appropriate header/footer information on each page
\fancypagestyle{plain}{
    \fancyhf{}
    \renewcommand{\headheight}{2.0em}
    \renewcommand{\headsep}{0.75em}
    \renewcommand{\headrulewidth}{1.0pt}
    \renewcommand{\footrulewidth}{0pt}
    \lhead{
        Suzerain explicit isothermal channel treatment
    }
    \rhead{
        Page \thepage{} of \pageref{LastPage}
    }
}
\pagestyle{plain}

% Paragraph spacing
\setlength{\parindent}{0em}
\setlength{\parskip}{2.0ex plus 0.75ex minus 0.75ex}

% Document-specific commands

\begin{document}

\subsection*{Setting}

We advance nondimensional density $\rho$, momentum $\vec{m}=\rho{}\vec{u}$, and
total energy $e = \rho{}\tilde{e}$ according to
\begin{subequations}
\begin{align}
  \partial_{t} \rho{} &= R_{\rho}\!\left(\rho,\vec{m},e\right)
  \\
  \partial_{t} m      &= \vec{R}_{m}\!\left(\rho,\vec{m},e\right)
                       + \rho \vec{f}_{m}(t)
  \\
  \partial_{t} e      &= R_{e}\!\left(\rho,\vec{m},e\right)
                       + \vec{f}_{m}(t) \cdot \vec{m}
\end{align}
\end{subequations}
where $R_{\rho}$, $\vec{R}_{m}$, and $R_{e}$ are the spatial portion of the
compressible Navier--Stokes operator appropriate for the nondimensionalization.
The operator is assumed to enforce isothermal, no slip wall conditions.  We
will determine the space-invariant form of the acceleration $\vec{f}_{m}$
necessary to drive the isothermal channel problem similar to Coleman et
al.~\cite{Coleman1995Numerical}.

We assume a Fourier basis in the streamwise $x$ and spanwise $z$ direction as
well as an inhomogeneous treatment for wall-normal
$y\in\left[0,2\delta\right]$.  We assume that mean state quantities can be
obtained as a function of wall-normal position using the constant (``zero
zero'') Fourier modes.  Under this ergodic assumption, we denote
$\rho\!\left(\cdot,y,\cdot\right) = \left<\rho\left(x,y,z\right)\right>_{x,z}$
and likewise $\vec{m}\!\left(\cdot,y,\cdot\right) \coloneqq
\left<\vec{m}\left(x,y,z\right)\right>_{x,z}$.  We assume that temperature $T$
has been nondimensionalized so that $T_\text{wall}=1$.

Coleman et al.'s isothermal channel is characterized by
\begin{enumerate}
  \item A time-invariant bulk density $\bar{\rho} \coloneqq \frac{1}{2\delta}
        \int_{0}^{2\delta} \rho\!\left(\cdot,y,\cdot\right)\,dy $
  \item The no slip, isothermal boundary condition
        $\vec{u}=0$, $T = 1$ at $y = 0,2\delta$
  \item A time-invariant bulk streamwise momentum
        $\bar{m}_{x} \coloneqq \frac{1}{2\delta}
        \int_{0}^{2\delta} \bar{m}_{x}\!\left(\cdot,y,\cdot\right)\,dy $
\end{enumerate}

\subsection*{Analysis}

The problem as presented should provide a stationary bulk density $\bar{\rho}$
and enforce isothermal, no slip walls conditions.  We find $\vec{f}_{m} =
\left(f_{m_x},0,0\right)^{\textrm{T}}$ such that the bulk streamwise momentum
$\bar{m}_{x}$ remains constant in time:
\begin{align}
  \partial_{t} \bar{m}_x
   = \frac{1}{2\delta} \int_{0}^{2\delta}
     \partial_{t} m_{x} \!\left(\cdot,y,\cdot\right) \, dy
  &= \frac{1}{2\delta} \int_{0}^{2\delta}
     \left[  R_{m_x}\!\left(\cdot,y,\cdot\right)
           + \rho\!\left(\cdot,y,\cdot\right)  f_{m_x}
     \right] \, dy
  \\
  &= \frac{1}{2\delta} \int_{0}^{2\delta}
     R_{m_x}\!\left(\cdot,y,\cdot\right) \, dy + \bar{\rho} f_{m_x}
   = 0
\end{align}
Rearranging we find $f_{m_x} = - \frac{1}{\bar{\rho}2\delta}
\int_{0}^{2\delta} R_{m_x}\!\left(\cdot,y,\cdot\right) \, dy$.

\subsection*{Implementation}

We use that for
$\phi\in\left\{\rho,m_{x}\right\}$
\begin{align}
  \frac{1}{2\delta} \int_{0}^{2\delta} \phi\!\left(\cdot,y,\cdot\right)\,dy
  &=
  c \cdot \phi\!\left(\cdot,y,\cdot\right)
\end{align}
where $c$ is a precomputable coefficient vector depending on the chosen
wall-normal basis.

Assuming that the prior state satisfies the isothermal channel conditions with
bulk density $\bar{\rho}$, one (admittedly suboptimal) way to treat the
problem looks as follows:
\begin{enumerate}
  \item Compute $\bar{\rho} = c \cdot \rho\!\left(\cdot,y,\cdot\right)$.
  \item Compute $R_{\rho}$, $R_{\vec{m}}$, and $R_{e}$ in wavespace.
  \item Compute temporary value $\alpha =
        \bar{\rho}^{-1} c \cdot R_{m_{x}}\!\left(\cdot,y,\cdot\right)$.
  \item Apply $\rho f_{m_x}$ by updating
        $R_{m_x}\!\left(\cdot,y,\cdot\right) -{}\!\!\!{}=
        \alpha \, \rho\!\left(\cdot,y,\cdot\right)$ for $y\neq0,2\delta$.
  \item Apply $\vec{f}_{m}\cdot\vec{m} = f_{m_x} m_x$ by updating
        $R_{e}\!\left(\cdot,y,\cdot\right) -{}\!\!\!{}=
        \alpha \, m_{x}\!\left(\cdot,y,\cdot\right)$
        for $y\neq0,2\delta$.
\end{enumerate}
Care should be taken when advancing coefficient (rather than collocation point)
state to ensure only the relevant collocation points are impacted.  One then
advances $\partial_{t}\rho = R_{\rho}$, $\partial_{t} \vec{m} = R_{\vec{m}}$,
and $\partial_{t} e = R_{e}$ using regular time integration techniques.  Note
that $f_{m_x}$ is not applied at $y=0,2\delta$ but that these points may be
included in the momentum integral computation ($\alpha$) as they are
identically zero from earlier boundary condition enforcement.  Each of these
computations may be performed in wavespace as they are linear in at most one
state variable.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%% Bibliography %%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{amsplain}
\bibliography{references}


\end{document}
